{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-2d0d6d08\"],{\"73c9\":function(e,t,a){\"use strict\";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"el-dialog\",{attrs:{visible:e.visible,title:e.dataForm.id?e.$t(\"update\"):e.$t(\"add\"),\"close-on-click-modal\":!1,\"close-on-press-escape\":!1},on:{\"update:visible\":function(t){e.visible=t}}},[a(\"el-form\",{ref:\"dataForm\",attrs:{model:e.dataForm,rules:e.dataRule,\"label-width\":\"120px\"},nativeOn:{keyup:function(t){return!t.type.indexOf(\"key\")&&e._k(t.keyCode,\"enter\",13,t.key,\"Enter\")?null:e.dataFormSubmitHandle()}}},[a(\"el-form-item\",{attrs:{prop:\"beanName\",label:e.$t(\"schedule.beanName\")}},[a(\"el-input\",{attrs:{disabled:!0},model:{value:e.dataForm.beanName,callback:function(t){e.$set(e.dataForm,\"beanName\",t)},expression:\"dataForm.beanName\"}})],1),a(\"el-form-item\",{attrs:{label:\"账号选择\",\"label-width\":e.formLabelWidth,prop:\"account\"}},[a(\"el-select\",{staticClass:\"m-2\",attrs:{clearable:\"\",placeholder:\"Select\",size:\"large\"},model:{value:e.dataForm.account,callback:function(t){e.$set(e.dataForm,\"account\",t)},expression:\"dataForm.account\"}},e._l(e.accountList,(function(e){return a(\"el-option\",{key:e.id,attrs:{label:e.user,value:e.user}})})),1),a(\"el-button\",{staticStyle:{\"margin-left\":\"20px\"},attrs:{type:\"primary\",loading:e.isCommitLogin,disabled:\"\"===e.dataForm.account},on:{click:e.login}},[e._v(\"登录 \")])],1),a(\"el-form-item\",{attrs:{label:\"起始港\",\"label-width\":e.formLabelWidth,prop:\"startPort.cityFullNameEn\"}},[a(\"el-select\",{attrs:{change:\"\",multiple:!1,filterable:\"\",remote:\"\",\"reserve-keyword\":\"\",placeholder:\"请输入关键词\",\"remote-method\":e.getStartPort,loading:e.selectFrom.loading},model:{value:e.showStartPortName,callback:function(t){e.showStartPortName=t},expression:\"showStartPortName\"}},e._l(e.selectFrom.options,(function(e){return a(\"el-option\",{key:e.id,attrs:{value:e.cityFullNameCn+\"-\"+e.cityFullNameEn}})})),1)],1),a(\"el-form-item\",{attrs:{label:\"目的港\",\"label-width\":e.formLabelWidth,prop:\"endPort.cityFullNameEn\"}},[a(\"el-select\",{attrs:{change:\"\",multiple:!1,filterable:\"\",remote:\"\",\"reserve-keyword\":\"\",placeholder:\"请输入关键词\",\"remote-method\":e.getEndPort,loading:e.selectTo.loading},model:{value:e.showEndPortName,callback:function(t){e.showEndPortName=t},expression:\"showEndPortName\"}},e._l(e.selectTo.options,(function(e){return a(\"el-option\",{key:e.id,attrs:{value:e.cityFullNameCn+\"-\"+e.cityFullNameEn}})})),1)],1),a(\"el-form-item\",{attrs:{label:\"集装箱类型\",\"label-width\":e.formLabelWidth,prop:\"equipment\"}},[a(\"el-select\",{attrs:{placeholder:\"请选择\"},model:{value:e.dataForm.equipment,callback:function(t){e.$set(e.dataForm,\"equipment\",t)},expression:\"dataForm.equipment\"}},e._l(e.equipmentType,(function(e){return a(\"el-option\",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a(\"el-form-item\",{attrs:{label:\"数量\",\"label-width\":e.formLabelWidth,prop:\"quantity\"}},[a(\"el-input-number\",{attrs:{min:1,max:100,label:\"集装箱数量\"},model:{value:e.dataForm.quantity,callback:function(t){e.$set(e.dataForm,\"quantity\",e._n(t))},expression:\"dataForm.quantity\"}})],1),a(\"el-form-item\",{attrs:{label:\"指定航名航次\",\"label-width\":e.formLabelWidth,prop:\"isNeedVesselName\"}},[a(\"el-radio\",{attrs:{label:!0},model:{value:e.dataForm.isNeedVesselName,callback:function(t){e.$set(e.dataForm,\"isNeedVesselName\",t)},expression:\"dataForm.isNeedVesselName\"}},[e._v(\"是\")]),a(\"el-radio\",{attrs:{label:!1},model:{value:e.dataForm.isNeedVesselName,callback:function(t){e.$set(e.dataForm,\"isNeedVesselName\",t)},expression:\"dataForm.isNeedVesselName\"}},[e._v(\"否\")])],1),e.dataForm.isNeedVesselName?a(\"el-form-item\",{attrs:{label:\"航名\",\"label-width\":e.formLabelWidth,prop:\"vesselName\"}},[a(\"el-input\",{attrs:{autocomplete:\"off\"},model:{value:e.dataForm.vesselName,callback:function(t){e.$set(e.dataForm,\"vesselName\",t)},expression:\"dataForm.vesselName\"}})],1):e._e(),e.dataForm.isNeedVesselName?a(\"el-form-item\",{attrs:{label:\"航次\",\"label-width\":e.formLabelWidth,prop:\"voyage\"}},[a(\"el-input\",{attrs:{autocomplete:\"off\"},model:{value:e.dataForm.voyage,callback:function(t){e.$set(e.dataForm,\"voyage\",t)},expression:\"dataForm.voyage\"}})],1):e._e(),a(\"el-form-item\",{attrs:{label:\"可接受最大价格\",\"label-width\":e.formLabelWidth,prop:\"price\"}},[a(\"el-input-number\",{attrs:{min:0,max:99999},model:{value:e.dataForm.price,callback:function(t){e.$set(e.dataForm,\"price\",e._n(t))},expression:\"dataForm.price\"}})],1),a(\"el-form-item\",{attrs:{label:\"预计开航时间\"}},[a(\"el-col\",{attrs:{span:11}},[a(\"el-date-picker\",{staticStyle:{width:\"100%\"},attrs:{type:\"date\",placeholder:\"最早开航时间\"},model:{value:e.dataForm.startDate,callback:function(t){e.$set(e.dataForm,\"startDate\",t)},expression:\"dataForm.startDate\"}})],1),a(\"el-col\",{staticClass:\"line\",attrs:{span:2}},[e._v(\"-\")]),a(\"el-col\",{attrs:{span:11}},[a(\"el-date-picker\",{staticStyle:{width:\"100%\"},attrs:{type:\"date\",placeholder:\"最晚开航时间\"},model:{value:e.dataForm.endDate,callback:function(t){e.$set(e.dataForm,\"endDate\",t)},expression:\"dataForm.endDate\"}})],1)],1),a(\"el-form-item\",{attrs:{label:\"搜索子账号\",\"label-width\":e.formLabelWidth,prop:\"orderAccount\"}},[a(\"el-select\",{attrs:{multiple:\"\",placeholder:\"请选择\"},model:{value:e.dataForm.childAccount,callback:function(t){e.$set(e.dataForm,\"childAccount\",t)},expression:\"dataForm.childAccount\"}},e._l(e.childAccountList,(function(e){return a(\"el-option\",{key:e.id,attrs:{label:e.user,value:e.user}})})),1)],1),a(\"el-form-item\",{attrs:{prop:\"cronExpression\",label:e.$t(\"schedule.cronExpression\")}},[a(\"el-popover\",{model:{value:e.cronPopover,callback:function(t){e.cronPopover=t},expression:\"cronPopover\"}},[a(\"cron\",{attrs:{i18n:\"cn\"},on:{change:e.changeCron,close:function(t){e.cronPopover=!1}}}),a(\"el-input\",{attrs:{slot:\"reference\",placeholder:e.$t(\"schedule.cronExpressionTips\")},on:{click:function(t){e.cronPopover=!0}},slot:\"reference\",model:{value:e.dataForm.cronExpression,callback:function(t){e.$set(e.dataForm,\"cronExpression\",t)},expression:\"dataForm.cronExpression\"}})],1)],1),a(\"el-form-item\",{attrs:{prop:\"remark\",label:e.$t(\"schedule.remark\")}},[a(\"el-input\",{attrs:{placeholder:e.$t(\"schedule.remark\")},model:{value:e.dataForm.remark,callback:function(t){e.$set(e.dataForm,\"remark\",t)},expression:\"dataForm.remark\"}})],1)],1),a(\"template\",{slot:\"footer\"},[a(\"el-button\",{on:{click:function(t){e.visible=!1}}},[e._v(e._s(e.$t(\"cancel\")))]),a(\"el-button\",{attrs:{loading:e.isCommitForm,type:\"primary\"},on:{click:function(t){return e.dataFormSubmitHandle()}}},[e._v(e._s(e.$t(\"confirm\")))])],1)],2)},r=[],l=(a(\"4160\"),a(\"159b\"),a(\"b047\")),i=a.n(l),s=a(\"117d\"),n=a(\"b775\");function c(e){return Object(n[\"a\"])({url:\"/oocl/account\",method:\"GET\",params:{isOrderAccount:e}})}function m(e){return Object(n[\"a\"])({url:\"/oocl/login\",method:\"POST\",data:{username:e}})}function d(e,t,a){return Object(n[\"a\"])({url:\"/oocl/port\",method:\"POST\",data:{cityFullName:e,cookieValue:t,tokenValue:a}})}var u={data:function(){return{visible:!1,showStartPortName:\"\",showEndPortName:\"\",dataForm:{beanName:\"\".concat(this.$route.params.crawlerName),params:\"{}\",cronExpression:\"0/2 * * * * ? *\",remark:\"\",status:0,startPort:{bookingTerritory:\"\",cityFullNameCn:\"\",cityFullNameEn:\"\",cityName:\"\",equalsScore:\"\",id:\"\",isActive:\"\",orderScore:\"\",stateCode:\"\",stateName:\"\",unlocode:\"\",updateTime:\"\"},endPort:{bookingTerritory:\"\",cityFullNameCn:\"\",cityFullNameEn:\"\",cityName:\"\",equalsScore:\"\",id:\"\",isActive:\"\",orderScore:\"\",stateCode:\"\",stateName:\"\",unlocode:\"\",updateTime:\"\"},equipment:\"\",vesselName:\"\",voyage:\"\",quantity:1,price:0,account:\"\",cookie:\"\",token:\"\",startDate:\"\",endDate:\"\",childAccount:[],isNeedVesselName:!1,type:1},cronPopover:!1,dialogTableVisible:!1,dialogFormVisible:!1,isCommitLogin:!1,isCommitForm:!1,formLabelWidth:\"120px\",selectFrom:{options:[],value:[],list:[],loading:!1},selectTo:{options:[],value:[],list:[],loading:!1},equipmentType:[{value:\"20GP\",label:\"20GP\"},{value:\"40GP\",label:\"40GP\"},{value:\"40HQ\",label:\"40HQ\"}],accountList:[],childAccountList:[]}},components:{cron:s[\"cron\"]},computed:{dataRule:function(){return{beanName:[{required:!0,message:this.$t(\"validate.required\"),trigger:\"blur\"}],cronExpression:[{required:!0,message:this.$t(\"validate.required\"),trigger:\"blur\"}],account:[{required:!0,message:this.$t(\"validate.required\"),trigger:\"blur\"}],showStartPortName:[{required:!0,message:this.$t(\"validate.required\"),trigger:\"blur\"}],showEndPortName:[{required:!0,message:this.$t(\"validate.required\"),trigger:\"blur\"}],equipment:[{required:!0,message:this.$t(\"validate.required\"),trigger:\"blur\"}],startDate:[{required:!0,message:this.$t(\"validate.required\"),trigger:\"blur\"}],childAccount:[{required:!0,message:this.$t(\"validate.required\"),trigger:\"blur\"}]}}},watch:{deep:!0,showStartPortName:function(e,t){var a=this;this.selectFrom.options.forEach((function(t){t.cityFullNameCn+\"-\"+t.cityFullNameEn===e&&(a.dataForm.startPort=t)}))},showEndPortName:function(e,t){var a=this;this.selectTo.options.forEach((function(t){t.cityFullNameCn+\"-\"+t.cityFullNameEn===e&&(a.dataForm.endPort=t)}))}},methods:{getStartPort:function(e){var t=this;\"\"!==e?(this.selectFrom.loading=!0,setTimeout((function(){t.selectFrom.loading=!1,console.log(t.dataForm.cookie),d(e,t.dataForm.cookie,t.dataForm.token).then((function(e){var a=e.data;\"\"===a.data&&t.$message.info(\"未搜索到结果\"),t.selectFrom.list=a.data||[],t.selectFrom.options=t.selectFrom.list}))}),50)):this.selectFrom.options=[]},getEndPort:function(e){var t=this;\"\"!==e?(this.selectTo.loading=!0,setTimeout((function(){t.selectTo.loading=!1,d(e,t.dataForm.cookie,t.dataForm.token).then((function(e){var a=e.data;\"\"===a.data&&t.$message.info(\"未搜索到结果\"),t.selectTo.list=a.data||[],t.selectTo.options=t.selectTo.list}))}),50)):this.selectFrom.options=[]},login:function(){var e=this;this.isCommitLogin=!0,m(this.dataForm.account).then((function(t){var a=t.data;0===a.code?(e.$message.success(\"登陆成功\"),e.dataForm.cookie=a.data.cookie,e.dataForm.token=a.data.token):e.$message.error(\"登陆失败\"),e.isCommitLogin=!1}))},init:function(){var e=this;this.visible=!0,this.$nextTick((function(){e.showStartPortName=\"\",e.showEndPortName=\"\",e.dataForm.startDate=\"\",e.dataForm.endDate=\"\",e.dataForm.childAccount=[],e.$refs.dataForm.resetFields(),e.dataForm.id&&e.getInfo()}))},changeCron:function(e){this.dataForm.cronExpression=e},getInfo:function(){var e=this;this.$http.get(\"/sys/schedule/\".concat(this.dataForm.id)).then((function(t){var a=t.data;if(0!==a.code)return e.$message.error(a.msg);e.dataForm=a.data,e.showStartPortName=e.dataForm.startPort.cityFullNameCn+\"-\"+e.dataForm.startPort.cityFullNameEn,e.showEndPortName=e.dataForm.endPort.cityFullNameCn+\"-\"+e.dataForm.endPort.cityFullNameEn})).catch((function(){}))},dataFormSubmitHandle:i()((function(){var e=this;this.$refs.dataForm.validate((function(t){if(!t)return!1;var a={tag:\"oocl\",data:JSON.stringify(e.dataForm)};e.isCommitForm=!0,e.$http[e.dataForm.id?\"put\":\"post\"](\"/sys/schedule\",a).then((function(t){var a=t.data;if(0!==a.code)return e.visible=!1,e.$message.error(a.msg);e.$message({message:e.$t(\"prompt.success\"),type:\"success\",duration:500,onClose:function(){e.visible=!1,e.$emit(\"refreshDataList\")}}),e.isCommitForm=!1})).catch((function(){}))}))}),1e3,{leading:!0,trailing:!1})},mounted:function(){var e=this;c(!0).then((function(t){var a=t.data;e.accountList=a.data})),c(!1).then((function(t){var a=t.data;e.childAccountList=a.data})),this.dataForm.cookie=\"\",this.dataForm.token=\"\"}},p=u,h=a(\"2877\"),f=Object(h[\"a\"])(p,o,r,!1,null,null,null);t[\"default\"]=f.exports}}]);","extractedComments":[]}