{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-4b4fed95\"],{\"2bdd\":function(t,e,a){\"use strict\";a.d(e,\"a\",(function(){return r})),a.d(e,\"c\",(function(){return n})),a.d(e,\"b\",(function(){return i}));var o=a(\"b775\");function r(t,e){return Object(o[\"a\"])({url:\"/spider/account/oocl\",method:\"GET\",params:{isOrderAccount:t,type:e}})}function n(t){return Object(o[\"a\"])({url:\"/oocl/login\",method:\"POST\",data:{username:t}})}function i(t,e,a){return Object(o[\"a\"])({url:\"/oocl/port\",method:\"POST\",data:{cityFullName:t,cookieValue:e,tokenValue:a}})}},b62b:function(t,e,a){\"use strict\";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"el-dialog\",{attrs:{visible:t.visible,title:t.dataForm.id?t.$t(\"update\"):t.$t(\"add\"),\"close-on-click-modal\":!1,\"close-on-press-escape\":!1},on:{\"update:visible\":function(e){t.visible=e}}},[a(\"el-form\",{ref:\"dataForm\",attrs:{model:t.dataForm,rules:t.dataRule,\"label-width\":\"120px\"},nativeOn:{keyup:function(e){return!e.type.indexOf(\"key\")&&t._k(e.keyCode,\"enter\",13,e.key,\"Enter\")?null:t.dataFormSubmitHandle()}}},[a(\"el-form-item\",{attrs:{prop:\"beanName\",label:t.$t(\"schedule.beanName\")}},[a(\"el-input\",{attrs:{disabled:!0},model:{value:t.dataForm.beanName,callback:function(e){t.$set(t.dataForm,\"beanName\",e)},expression:\"dataForm.beanName\"}})],1),a(\"el-form-item\",{attrs:{label:\"账号选择\",\"label-width\":t.formLabelWidth,prop:\"account\"}},[a(\"el-select\",{staticClass:\"m-2\",attrs:{clearable:\"\",placeholder:\"Select\",size:\"large\"},model:{value:t.dataForm.account,callback:function(e){t.$set(t.dataForm,\"account\",e)},expression:\"dataForm.account\"}},t._l(t.accountList,(function(t){return a(\"el-option\",{key:t.id,attrs:{label:t.user,value:t.user}})})),1),a(\"el-button\",{staticStyle:{\"margin-left\":\"20px\"},attrs:{type:\"primary\",loading:t.isCommitLogin,disabled:\"\"===t.dataForm.account},on:{click:t.login}},[t._v(\"登录 \")])],1),a(\"el-form-item\",{attrs:{label:\"起始港\",\"label-width\":t.formLabelWidth,prop:\"startPort.cityFullNameEn\"}},[a(\"el-select\",{attrs:{change:\"\",multiple:!1,filterable:\"\",remote:\"\",\"reserve-keyword\":\"\",placeholder:\"请输入关键词\",\"remote-method\":t.getStartPort,loading:t.selectFrom.loading},model:{value:t.showStartPortName,callback:function(e){t.showStartPortName=e},expression:\"showStartPortName\"}},t._l(t.selectFrom.options,(function(t){return a(\"el-option\",{key:t.id,attrs:{value:t.cityFullNameCn+\"-\"+t.cityFullNameEn}})})),1)],1),a(\"el-form-item\",{attrs:{label:\"目的港\",\"label-width\":t.formLabelWidth,prop:\"endPort.cityFullNameEn\"}},[a(\"el-select\",{attrs:{change:\"\",multiple:!1,filterable:\"\",remote:\"\",\"reserve-keyword\":\"\",placeholder:\"请输入关键词\",\"remote-method\":t.getEndPort,loading:t.selectTo.loading},model:{value:t.showEndPortName,callback:function(e){t.showEndPortName=e},expression:\"showEndPortName\"}},t._l(t.selectTo.options,(function(t){return a(\"el-option\",{key:t.id,attrs:{value:t.cityFullNameCn+\"-\"+t.cityFullNameEn}})})),1)],1),a(\"el-form-item\",{attrs:{label:\"预计开航时间\"}},[a(\"el-col\",{attrs:{span:11}},[a(\"el-date-picker\",{staticStyle:{width:\"100%\"},attrs:{type:\"date\",placeholder:\"最早开航时间\"},model:{value:t.dataForm.startDate,callback:function(e){t.$set(t.dataForm,\"startDate\",e)},expression:\"dataForm.startDate\"}})],1),a(\"el-col\",{staticClass:\"line\",attrs:{span:2}},[t._v(\"-\")]),a(\"el-col\",{attrs:{span:11}},[a(\"el-date-picker\",{staticStyle:{width:\"100%\"},attrs:{type:\"date\",placeholder:\"最晚开航时间\"},model:{value:t.dataForm.endDate,callback:function(e){t.$set(t.dataForm,\"endDate\",e)},expression:\"dataForm.endDate\"}})],1)],1),a(\"el-form-item\",{attrs:{prop:\"cronExpression\",label:t.$t(\"schedule.cronExpression\")}},[a(\"el-popover\",{model:{value:t.cronPopover,callback:function(e){t.cronPopover=e},expression:\"cronPopover\"}},[a(\"cron\",{attrs:{i18n:\"cn\"},on:{change:t.changeCron,close:function(e){t.cronPopover=!1}}}),a(\"el-input\",{attrs:{slot:\"reference\",placeholder:t.$t(\"schedule.cronExpressionTips\")},on:{click:function(e){t.cronPopover=!0}},slot:\"reference\",model:{value:t.dataForm.cronExpression,callback:function(e){t.$set(t.dataForm,\"cronExpression\",e)},expression:\"dataForm.cronExpression\"}})],1)],1),a(\"el-form-item\",{attrs:{prop:\"remark\",label:t.$t(\"schedule.remark\")}},[a(\"el-input\",{attrs:{placeholder:t.$t(\"schedule.remark\")},model:{value:t.dataForm.remark,callback:function(e){t.$set(t.dataForm,\"remark\",e)},expression:\"dataForm.remark\"}})],1)],1),a(\"template\",{slot:\"footer\"},[a(\"el-button\",{on:{click:function(e){t.visible=!1}}},[t._v(t._s(t.$t(\"cancel\")))]),a(\"el-button\",{attrs:{loading:t.isCommitForm,type:\"primary\"},on:{click:function(e){return t.dataFormSubmitHandle()}}},[t._v(t._s(t.$t(\"confirm\")))])],1)],2)},r=[],n=(a(\"4160\"),a(\"159b\"),a(\"b047\")),i=a.n(n),l=a(\"117d\"),s=a(\"2bdd\"),c={data:function(){return{visible:!1,showStartPortName:\"\",showEndPortName:\"\",dataForm:{beanName:\"\".concat(this.$route.params.crawlerName),params:\"{}\",cronExpression:\"0/2 * * * * ? *\",remark:\"\",status:0,startPort:{bookingTerritory:\"\",cityFullNameCn:\"\",cityFullNameEn:\"\",cityName:\"\",equalsScore:\"\",id:\"\",isActive:\"\",orderScore:\"\",stateCode:\"\",stateName:\"\",unlocode:\"\",updateTime:\"\"},endPort:{bookingTerritory:\"\",cityFullNameCn:\"\",cityFullNameEn:\"\",cityName:\"\",equalsScore:\"\",id:\"\",isActive:\"\",orderScore:\"\",stateCode:\"\",stateName:\"\",unlocode:\"\",updateTime:\"\"},account:\"\",cookie:\"\",token:\"\",startDate:\"\",endDate:\"\",type:3,flag:!1},cronPopover:!1,dialogTableVisible:!1,dialogFormVisible:!1,isCommitLogin:!1,isCommitForm:!1,formLabelWidth:\"120px\",selectFrom:{options:[],value:[],list:[],loading:!1},selectTo:{options:[],value:[],list:[],loading:!1},accountList:[]}},components:{cron:l[\"cron\"]},computed:{dataRule:function(){return{beanName:[{required:!0,message:this.$t(\"validate.required\"),trigger:\"blur\"}],cronExpression:[{required:!0,message:this.$t(\"validate.required\"),trigger:\"blur\"}]}}},watch:{deep:!0,showStartPortName:function(t,e){var a=this;this.selectFrom.options.forEach((function(e){e.cityFullNameCn+\"-\"+e.cityFullNameEn===t&&(a.dataForm.startPort=e)}))},showEndPortName:function(t,e){var a=this;this.selectTo.options.forEach((function(e){e.cityFullNameCn+\"-\"+e.cityFullNameEn===t&&(a.dataForm.endPort=e)}))}},methods:{getStartPort:function(t){var e=this;\"\"!==t?(this.selectFrom.loading=!0,setTimeout((function(){e.selectFrom.loading=!1,console.log(e.dataForm.cookie),Object(s[\"b\"])(t,e.dataForm.cookie,e.dataForm.token).then((function(t){var a=t.data;\"\"===a.data&&e.$message.info(\"未搜索到结果\"),e.selectFrom.list=a.data||[],e.selectFrom.options=e.selectFrom.list}))}),50)):this.selectFrom.options=[]},getEndPort:function(t){var e=this;\"\"!==t?(this.selectTo.loading=!0,setTimeout((function(){e.selectTo.loading=!1,Object(s[\"b\"])(t,e.dataForm.cookie,e.dataForm.token).then((function(t){var a=t.data;\"\"===a.data&&e.$message.info(\"未搜索到结果\"),e.selectTo.list=a.data||[],e.selectTo.options=e.selectTo.list}))}),50)):this.selectFrom.options=[]},login:function(){var t=this;this.isCommitLogin=!0,Object(s[\"c\"])(this.dataForm.account).then((function(e){var a=e.data;0===a.code?(t.$message.success(\"登陆成功\"),t.dataForm.cookie=a.data.cookie,t.dataForm.token=a.data.token):t.$message.error(a.msg),t.isCommitLogin=!1}))},init:function(){var t=this;this.visible=!0,this.$nextTick((function(){t.showStartPortName=\"\",t.showEndPortName=\"\",t.dataForm.startDate=\"\",t.dataForm.endDate=\"\",t.$refs.dataForm.resetFields(),t.dataForm.id&&t.getInfo()}))},changeCron:function(t){this.dataForm.cronExpression=t},getInfo:function(){var t=this;this.$http.get(\"/sys/schedule/\".concat(this.dataForm.id)).then((function(e){var a=e.data;if(0!==a.code)return t.$message.error(a.msg);t.dataForm=a.data,t.showStartPortName=t.dataForm.startPort.cityFullNameCn+\"-\"+t.dataForm.startPort.cityFullNameEn,t.showEndPortName=t.dataForm.endPort.cityFullNameCn+\"-\"+t.dataForm.endPort.cityFullNameEn})).catch((function(){}))},dataFormSubmitHandle:i()((function(){var t=this;this.$refs.dataForm.validate((function(e){if(!e)return!1;var a={tag:\"monitor\",data:JSON.stringify(t.dataForm)};t.isCommitForm=!0,t.$http[t.dataForm.id?\"put\":\"post\"](\"/sys/schedule\",a).then((function(e){var a=e.data;if(0!==a.code)return t.visible=!1,t.$message.error(a.msg);t.$message({message:t.$t(\"prompt.success\"),type:\"success\",duration:500,onClose:function(){t.visible=!1,t.$emit(\"refreshDataList\")}}),t.isCommitForm=!1})).catch((function(){}))}))}),1e3,{leading:!0,trailing:!1})},mounted:function(){var t=this;Object(s[\"a\"])(!1,0).then((function(e){var a=e.data;t.accountList=a.data}))},beforeMount:function(){this.dataForm.cookie=\"\",this.dataForm.token=\"\"}},m=c,d=a(\"2877\"),u=Object(d[\"a\"])(m,o,r,!1,null,null,null);e[\"default\"]=u.exports}}]);","extractedComments":[]}