{"remainingRequest":"D:\\codeSpace\\security-enterprise-FrontBackSplit_2.7.0\\security-enterprise-2.7.0\\security-enterprise-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\codeSpace\\security-enterprise-FrontBackSplit_2.7.0\\security-enterprise-2.7.0\\security-enterprise-admin\\src\\views\\main-navbar.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\codeSpace\\security-enterprise-FrontBackSplit_2.7.0\\security-enterprise-2.7.0\\security-enterprise-admin\\src\\views\\main-navbar.vue","mtime":1595727761900},{"path":"D:\\codeSpace\\security-enterprise-FrontBackSplit_2.7.0\\security-enterprise-2.7.0\\security-enterprise-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1639029294232},{"path":"D:\\codeSpace\\security-enterprise-FrontBackSplit_2.7.0\\security-enterprise-2.7.0\\security-enterprise-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":1639029293447},{"path":"D:\\codeSpace\\security-enterprise-FrontBackSplit_2.7.0\\security-enterprise-2.7.0\\security-enterprise-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1639029294232},{"path":"D:\\codeSpace\\security-enterprise-FrontBackSplit_2.7.0\\security-enterprise-2.7.0\\security-enterprise-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1639029303663}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1lc3NhZ2VzIH0gZnJvbSAnQC9pMThuJwppbXBvcnQgc2NyZWVuZnVsbCBmcm9tICdzY3JlZW5mdWxsJwppbXBvcnQgVXBkYXRlUGFzc3dvcmQgZnJvbSAnLi9tYWluLW5hdmJhci11cGRhdGUtcGFzc3dvcmQnCmltcG9ydCB7IGNsZWFyTG9naW5JbmZvIH0gZnJvbSAnQC91dGlscycKdmFyIHNvY2tldCA9IG51bGwKZXhwb3J0IGRlZmF1bHQgewogIGluamVjdDogWydyZWZyZXNoJ10sCiAgZGF0YSAoKSB7CiAgICByZXR1cm4gewogICAgICBpMThuTWVzc2FnZXM6IG1lc3NhZ2VzLAogICAgICB1cGRhdGVQYXNzd29yZFZpc2libGU6IGZhbHNlLAogICAgICBtZXNzYWdlVGlwOiBmYWxzZQogICAgfQogIH0sCiAgY29tcG9uZW50czogewogICAgVXBkYXRlUGFzc3dvcmQKICB9LAogIGNyZWF0ZWQgKCkgewogICAgdmFyIHZ1ZSA9IHRoaXMKICAgIHNvY2tldCA9IG5ldyBXZWJTb2NrZXQoYCR7d2luZG93LlNJVEVfQ09ORklHWydzb2NrZXRVUkwnXX1gKQogICAgc29ja2V0Lm9ub3BlbiA9IGZ1bmN0aW9uICgpIHt9CiAgICBzb2NrZXQub25lcnJvciA9IGZ1bmN0aW9uICgpIHsKICAgICAgdnVlLiRub3RpZnkuZXJyb3IoewogICAgICAgIHRpdGxlOiB2dWUuJHQoJ25vdGljZS5kaXNjb25uZWN0JyksCiAgICAgICAgbWVzc2FnZTogdnVlLiR0KCdub3RpY2UuZGlzY29ubmVjdE1lc3NhZ2UnKQogICAgICB9KQogICAgfQogICAgc29ja2V0Lm9ubWVzc2FnZSA9IGZ1bmN0aW9uIChldnQpIHsKICAgICAgY29uc3QgcmVzdWx0ID0gSlNPTi5wYXJzZShldnQuZGF0YSkKCiAgICAgIC8vIOWmguaenOaYr+acieaWsOaWh+acrOmAmuefpe+8jOWImeaPkOekuuacieaWsOmAmuefpQogICAgICBpZiAocmVzdWx0LnR5cGUgPT09IDApIHsKICAgICAgICB2dWUubWVzc2FnZVRpcCA9IHRydWUKICAgICAgICB2dWUuJG5vdGlmeSh7CiAgICAgICAgICB0aXRsZTogdnVlLiR0KCdub3RpY2UubmV3JyksCiAgICAgICAgICBtZXNzYWdlOiByZXN1bHQubXNnLAogICAgICAgICAgdHlwZTogJ2luZm8nLAogICAgICAgICAgZHVyYXRpb246IDUwMDAKICAgICAgICB9KQogICAgICB9CiAgICB9CgogICAgLy8g5pyq6K+76YCa55+l5pWwCiAgICB0aGlzLmdldFVuUmVhZENvdW50KCkKICB9LAogIG1ldGhvZHM6IHsKICAgIG15Tm90aWNlUm91dGVyICgpIHsKICAgICAgdGhpcy4kcm91dGVyLnJlcGxhY2UoJ25vdGljZS1ub3RpY2UtdXNlcicpCiAgICB9LAogICAgZ2V0VW5SZWFkQ291bnQgKCkgewogICAgICB0aGlzLiRodHRwLmdldChgL3N5cy9ub3RpY2UvbXlub3RpY2UvdW5yZWFkYCkudGhlbigoeyBkYXRhOiByZXMgfSkgPT4gewogICAgICAgIGlmIChyZXMuY29kZSAhPT0gMCkgewogICAgICAgICAgcmV0dXJuIHRoaXMuJG1lc3NhZ2UuZXJyb3IocmVzLm1zZykKICAgICAgICB9CiAgICAgICAgaWYgKHJlcy5kYXRhID4gMCkgewogICAgICAgICAgdGhpcy5tZXNzYWdlVGlwID0gdHJ1ZQogICAgICAgIH0KICAgICAgfSkuY2F0Y2goKCkgPT4ge30pCiAgICB9LAogICAgLy8g5YWo5bGPCiAgICBmdWxsc2NyZWVuSGFuZGxlICgpIHsKICAgICAgaWYgKCFzY3JlZW5mdWxsLmVuYWJsZWQpIHsKICAgICAgICByZXR1cm4gdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICBtZXNzYWdlOiB0aGlzLiR0KCdmdWxsc2NyZWVuLnByb21wdCcpLAogICAgICAgICAgdHlwZTogJ3dhcm5pbmcnLAogICAgICAgICAgZHVyYXRpb246IDUwMAogICAgICAgIH0pCiAgICAgIH0KICAgICAgc2NyZWVuZnVsbC50b2dnbGUoKQogICAgfSwKICAgIC8vIOS/ruaUueWvhueggQogICAgdXBkYXRlUGFzc3dvcmRIYW5kbGUgKCkgewogICAgICB0aGlzLnVwZGF0ZVBhc3N3b3JkVmlzaWJsZSA9IHRydWUKICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICAgIHRoaXMuJHJlZnMudXBkYXRlUGFzc3dvcmQuaW5pdCgpCiAgICAgIH0pCiAgICB9LAogICAgLy8g6YCA5Ye6CiAgICBsb2dvdXRIYW5kbGUgKCkgewogICAgICB0aGlzLiRjb25maXJtKHRoaXMuJHQoJ3Byb21wdC5pbmZvJywgeyAnaGFuZGxlJzogdGhpcy4kdCgnbG9nb3V0JykgfSksIHRoaXMuJHQoJ3Byb21wdC50aXRsZScpLCB7CiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6IHRoaXMuJHQoJ2NvbmZpcm0nKSwKICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiB0aGlzLiR0KCdjYW5jZWwnKSwKICAgICAgICB0eXBlOiAnd2FybmluZycKICAgICAgfSkudGhlbigoKSA9PiB7CiAgICAgICAgdGhpcy4kaHR0cC5wb3N0KCcvbG9nb3V0JykudGhlbigoeyBkYXRhOiByZXMgfSkgPT4gewogICAgICAgICAgaWYgKHJlcy5jb2RlICE9PSAwKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLiRtZXNzYWdlLmVycm9yKHJlcy5tc2cpCiAgICAgICAgICB9CiAgICAgICAgICBjbGVhckxvZ2luSW5mbygpCiAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7IG5hbWU6ICdsb2dpbicgfSkKICAgICAgICB9KS5jYXRjaCgoKSA9PiB7fSkKICAgICAgfSkuY2F0Y2goKCkgPT4ge30pCiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["main-navbar.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"main-navbar.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <nav class=\"aui-navbar\" :class=\"`aui-navbar--${$store.state.navbarLayoutType}`\">\n    <div class=\"aui-navbar__header\">\n      <h1 class=\"aui-navbar__brand\" @click=\"$router.push({ name: 'home' })\">\n        <a class=\"aui-navbar__brand-lg\" href=\"javascript:;\">{{ $t('brand.lg') }}</a>\n        <a class=\"aui-navbar__brand-mini\" href=\"javascript:;\">{{ $t('brand.mini') }}</a>\n      </h1>\n    </div>\n    <div class=\"aui-navbar__body\">\n      <el-menu class=\"aui-navbar__menu mr-auto\" mode=\"horizontal\">\n        <el-menu-item index=\"1\" @click=\"$store.state.sidebarFold = !$store.state.sidebarFold\">\n          <svg class=\"icon-svg aui-navbar__icon-menu aui-navbar__icon-menu--switch\" aria-hidden=\"true\"><use xlink:href=\"#icon-outdent\"></use></svg>\n        </el-menu-item>\n        <el-menu-item index=\"2\" @click=\"refresh()\">\n          <svg class=\"icon-svg aui-navbar__icon-menu aui-navbar__icon-menu--refresh\" aria-hidden=\"true\"><use xlink:href=\"#icon-sync\"></use></svg>\n        </el-menu-item>\n      </el-menu>\n      <el-menu class=\"aui-navbar__menu\" mode=\"horizontal\">\n        <el-menu-item index=\"1\">\n          <el-dropdown placement=\"bottom\" :show-timeout=\"0\">\n            <el-button size=\"mini\">{{ $t('_lang') }}</el-button>\n            <el-dropdown-menu slot=\"dropdown\">\n              <el-dropdown-item v-for=\"(val, key) in i18nMessages\" :key=\"key\" @click.native=\"$i18n.locale = key\">{{ val._lang }}</el-dropdown-item>\n            </el-dropdown-menu>\n          </el-dropdown>\n        </el-menu-item>\n        <el-menu-item index=\"2\">\n          <a href=\"//www.renren.io/\" target=\"_blank\">\n            <svg class=\"icon-svg aui-navbar__icon-menu\" aria-hidden=\"true\"><use xlink:href=\"#icon-earth\"></use></svg>\n          </a>\n        </el-menu-item>\n        <el-menu-item index=\"3\" v-if=\"$hasPermission('sys:notice:all')\">\n          <el-badge :is-dot=\"messageTip\">\n            <a href=\"#\"  @click=\"myNoticeRouter()\"><i class=\"el-icon-bell\"></i></a>\n          </el-badge>\n        </el-menu-item>\n        <el-menu-item index=\"4\" @click=\"fullscreenHandle()\">\n          <svg class=\"icon-svg aui-navbar__icon-menu\" aria-hidden=\"true\"><use xlink:href=\"#icon-fullscreen\"></use></svg>\n        </el-menu-item>\n        <el-menu-item index=\"5\" class=\"aui-navbar__avatar\">\n          <el-dropdown placement=\"bottom\" :show-timeout=\"0\">\n            <span class=\"el-dropdown-link\">\n              <img src=\"~@/assets/img/avatar.png\">\n              <span>{{ $store.state.user.name }}</span>\n              <i class=\"el-icon-arrow-down\"></i>\n            </span>\n            <el-dropdown-menu slot=\"dropdown\">\n              <el-dropdown-item @click.native=\"updatePasswordHandle()\">{{ $t('updatePassword.title') }}</el-dropdown-item>\n              <el-dropdown-item @click.native=\"logoutHandle()\">{{ $t('logout') }}</el-dropdown-item>\n            </el-dropdown-menu>\n          </el-dropdown>\n        </el-menu-item>\n      </el-menu>\n    </div>\n    <!-- 弹窗, 修改密码 -->\n    <update-password v-if=\"updatePasswordVisible\" ref=\"updatePassword\"></update-password>\n  </nav>\n</template>\n<script>\nimport { messages } from '@/i18n'\nimport screenfull from 'screenfull'\nimport UpdatePassword from './main-navbar-update-password'\nimport { clearLoginInfo } from '@/utils'\nvar socket = null\nexport default {\n  inject: ['refresh'],\n  data () {\n    return {\n      i18nMessages: messages,\n      updatePasswordVisible: false,\n      messageTip: false\n    }\n  },\n  components: {\n    UpdatePassword\n  },\n  created () {\n    var vue = this\n    socket = new WebSocket(`${window.SITE_CONFIG['socketURL']}`)\n    socket.onopen = function () {}\n    socket.onerror = function () {\n      vue.$notify.error({\n        title: vue.$t('notice.disconnect'),\n        message: vue.$t('notice.disconnectMessage')\n      })\n    }\n    socket.onmessage = function (evt) {\n      const result = JSON.parse(evt.data)\n\n      // 如果是有新文本通知，则提示有新通知\n      if (result.type === 0) {\n        vue.messageTip = true\n        vue.$notify({\n          title: vue.$t('notice.new'),\n          message: result.msg,\n          type: 'info',\n          duration: 5000\n        })\n      }\n    }\n\n    // 未读通知数\n    this.getUnReadCount()\n  },\n  methods: {\n    myNoticeRouter () {\n      this.$router.replace('notice-notice-user')\n    },\n    getUnReadCount () {\n      this.$http.get(`/sys/notice/mynotice/unread`).then(({ data: res }) => {\n        if (res.code !== 0) {\n          return this.$message.error(res.msg)\n        }\n        if (res.data > 0) {\n          this.messageTip = true\n        }\n      }).catch(() => {})\n    },\n    // 全屏\n    fullscreenHandle () {\n      if (!screenfull.enabled) {\n        return this.$message({\n          message: this.$t('fullscreen.prompt'),\n          type: 'warning',\n          duration: 500\n        })\n      }\n      screenfull.toggle()\n    },\n    // 修改密码\n    updatePasswordHandle () {\n      this.updatePasswordVisible = true\n      this.$nextTick(() => {\n        this.$refs.updatePassword.init()\n      })\n    },\n    // 退出\n    logoutHandle () {\n      this.$confirm(this.$t('prompt.info', { 'handle': this.$t('logout') }), this.$t('prompt.title'), {\n        confirmButtonText: this.$t('confirm'),\n        cancelButtonText: this.$t('cancel'),\n        type: 'warning'\n      }).then(() => {\n        this.$http.post('/logout').then(({ data: res }) => {\n          if (res.code !== 0) {\n            return this.$message.error(res.msg)\n          }\n          clearLoginInfo()\n          this.$router.push({ name: 'login' })\n        }).catch(() => {})\n      }).catch(() => {})\n    }\n  }\n}\n</script>\n"]}]}