{"remainingRequest":"D:\\codeSpace\\security-enterprise-FrontBackSplit_2.7.0\\security-enterprise-2.7.0\\security-enterprise-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\codeSpace\\security-enterprise-FrontBackSplit_2.7.0\\security-enterprise-2.7.0\\security-enterprise-admin\\src\\components\\ren-process-start\\src\\ren-process-start.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\codeSpace\\security-enterprise-FrontBackSplit_2.7.0\\security-enterprise-2.7.0\\security-enterprise-admin\\src\\components\\ren-process-start\\src\\ren-process-start.vue","mtime":1595727761854},{"path":"D:\\codeSpace\\security-enterprise-FrontBackSplit_2.7.0\\security-enterprise-2.7.0\\security-enterprise-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\codeSpace\\security-enterprise-FrontBackSplit_2.7.0\\security-enterprise-2.7.0\\security-enterprise-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\codeSpace\\security-enterprise-FrontBackSplit_2.7.0\\security-enterprise-2.7.0\\security-enterprise-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\codeSpace\\security-enterprise-FrontBackSplit_2.7.0\\security-enterprise-2.7.0\\security-enterprise-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KCmltcG9ydCBxcyBmcm9tICdxcycKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdSZW5Qcm9jZXNzU3RhcnQnLAogIGRhdGEgKCkgewogICAgcmV0dXJuIHsKICAgICAgZm9ybVVybDogJycsCiAgICAgIGluc3RhbmNlSWRVcmw6ICcnLAogICAgICBmb3JtTmFtZTogbnVsbCwKICAgICAgcm9vdE9iajogbnVsbCwKICAgICAgZGF0YUZvcm06IHsKICAgICAgICBwcm9jZXNzRGVmaW5pdGlvbktleTogJycKICAgICAgfSwKICAgICAgLy8g5Zue6LCD5Ye95pWwCiAgICAgIGNhbGxiYWNrczogewogICAgICAgIHN0YXJ0UHJvY2Vzc1N1Y2Nlc3NDYWxsYmFjazogbnVsbCwKICAgICAgICBzdGFydFByb2Nlc3NFcnJvckNhbGxiYWNrOiBudWxsLAogICAgICAgIGZvcm1TYXZlU3VjY2Vzc0NhbGxiYWNrOiBudWxsLAogICAgICAgIGZvcm1TYXZlRXJyb3JDYWxsYmFjazogbnVsbAogICAgICB9CiAgICB9CiAgfSwKICBjb21wb25lbnRzOiB7CiAgfSwKICBjcmVhdGVkICgpIHsKICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgdGhpcy5mb3JtVXJsID0gdGhpcy5zYXZlRm9ybVVybAogICAgICB0aGlzLmluc3RhbmNlSWRVcmwgPSB0aGlzLnVwZGF0ZUluc3RhbmNlSWRVcmwKICAgICAgdGhpcy5mb3JtTmFtZSA9IHRoaXMuZGF0YUZvcm1OYW1lCiAgICB9KQogIH0sCiAgcHJvcHM6IHsKICAgIHNhdmVGb3JtVXJsOiBTdHJpbmcsCiAgICB1cGRhdGVJbnN0YW5jZUlkVXJsOiBTdHJpbmcsCiAgICBkYXRhRm9ybU5hbWU6IFN0cmluZwogIH0sCiAgd2F0Y2g6IHsKICAgIHNhdmVGb3JtVXJsICh2YWwpIHsKICAgICAgdGhpcy5mb3JtVXJsID0gdmFsCiAgICB9LAogICAgdXBkYXRlSW5zdGFuY2VJZFVybCAodmFsKSB7CiAgICAgIHRoaXMuaW5zdGFuY2VJZFVybCA9IHZhbAogICAgfSwKICAgIGRhdGFGb3JtTmFtZSAodmFsKSB7CiAgICAgIHRoaXMuZm9ybU5hbWUgPSB2YWwKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIC8vIOWQr+WKqOa1geeoi+S6i+S7tgogICAgcHJvY2Vzc1N0YXJ0SGFuZGxlICgpIHsKICAgICAgaWYgKCF0aGlzLmZvcm1VcmwpIHsKICAgICAgICByZXR1cm4gdGhpcy4kbWVzc2FnZS5lcnJvcih0aGlzLiR0KCdwcm9jZXNzLmZvcm1VUkxFcnJvcicpKQogICAgICB9CiAgICAgIGlmICghdGhpcy5kYXRhRm9ybS5wcm9jZXNzRGVmaW5pdGlvbktleSkgewogICAgICAgIHJldHVybiB0aGlzLiRtZXNzYWdlLmVycm9yKHRoaXMuJHQoJ3Byb2Nlc3Mua2V5RXJyb3InKSkKICAgICAgfQogICAgICBpZiAoIXRoaXMuZm9ybU5hbWUpIHsKICAgICAgICByZXR1cm4gdGhpcy4kbWVzc2FnZS5lcnJvcih0aGlzLiR0KCdwcm9jZXNzLmZvcm1OYW1lRXJyb3InKSkKICAgICAgfQogICAgICB0aGlzLnJvb3RPYmouJHJlZnNbdGhpcy5mb3JtTmFtZV0udmFsaWRhdGUoKHZhbGlkKSA9PiB7CiAgICAgICAgaWYgKCF2YWxpZCkgewogICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgfQogICAgICAgIHRoaXMuJGh0dHAuZ2V0KGAvYWN0L3Byb2Nlc3MvbGFzdGVzdFBhZ2VgLCB7CiAgICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgICAga2V5OiB0aGlzLmRhdGFGb3JtLnByb2Nlc3NEZWZpbml0aW9uS2V5CiAgICAgICAgICB9CiAgICAgICAgfSkudGhlbigoeyBkYXRhOiByZXMgfSkgPT4gewogICAgICAgICAgaWYgKHJlcy5jb2RlICE9PSAwKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLiRtZXNzYWdlLmVycm9yKHJlcy5tc2cpCiAgICAgICAgICB9CiAgICAgICAgICBpZiAoIXJlcy5kYXRhLmxpc3QgfHwgcmVzLmRhdGEubGlzdC5sZW5ndGggPD0gMCkgewogICAgICAgICAgICByZXR1cm4gdGhpcy4kbWVzc2FnZS5lcnJvcih0aGlzLiR0KCdwcm9jZXNzLm5vdEV4aXN0RXJyb3InKSkKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuJGh0dHBbJ3Bvc3QnXSh0aGlzLmZvcm1VcmwsIHRoaXMucm9vdE9ialt0aGlzLmZvcm1OYW1lXSkudGhlbigoeyBkYXRhOiByZXMgfSkgPT4gewogICAgICAgICAgICBpZiAocmVzLmNvZGUgIT09IDApIHsKICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHJlcy5tc2cpCiAgICAgICAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2tzLmZvcm1TYXZlRXJyb3JDYWxsYmFjaykgewogICAgICAgICAgICAgICAgdGhpcy5jYWxsYmFja3MuZm9ybVNhdmVFcnJvckNhbGxiYWNrKHJlcykKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2tzLmZvcm1TYXZlU3VjY2Vzc0NhbGxiYWNrKSB7CiAgICAgICAgICAgICAgdGhpcy5jYWxsYmFja3MuZm9ybVNhdmVTdWNjZXNzQ2FsbGJhY2socmVzKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghcmVzLmRhdGEuYnVzaW5lc3NLZXkpIHsKICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kbWVzc2FnZS5lcnJvcih0aGlzLiR0KCdwcm9jZXNzLmJ1c2luZXNzS2V5RXJyb3InKSkKICAgICAgICAgICAgICAvLyB0aGlzLnN0YXJ0UHJvY2Vzcyh0aGlzLmRhdGFGb3JtLnByb2Nlc3NEZWZpbml0aW9uS2V5LCBudWxsLCB0aGlzLnJvb3RPYmpbdGhpcy5mb3JtTmFtZV0pCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgdGhpcy5zdGFydFByb2Nlc3ModGhpcy5kYXRhRm9ybS5wcm9jZXNzRGVmaW5pdGlvbktleSwgcmVzLmRhdGEuYnVzaW5lc3NLZXksIHRoaXMucm9vdE9ialt0aGlzLmZvcm1OYW1lXSkKICAgICAgICAgICAgfQogICAgICAgICAgfSkuY2F0Y2goKCkgPT4ge30pCiAgICAgICAgfSkuY2F0Y2goKCkgPT4ge30pCiAgICAgIH0pCiAgICB9LAogICAgLy8g5ZCv5Yqo5rWB56iLCiAgICBzdGFydFByb2Nlc3MgKHByb2Nlc3NEZWZpbml0aW9uS2V5LCBidXNpbmVzc0tleSwgZm9ybURhdGEpIHsKICAgICAgdmFyIGRhdGEgPSB7CiAgICAgICAgcHJvY2Vzc0RlZmluaXRpb25LZXk6IHByb2Nlc3NEZWZpbml0aW9uS2V5LAogICAgICAgIGJ1c2luZXNzS2V5OiBidXNpbmVzc0tleSwKICAgICAgICB2YXJpYWJsZXM6IGZvcm1EYXRhCiAgICAgIH0KICAgICAgdGhpcy4kaHR0cFsncG9zdCddKCcvYWN0L3J1bm5pbmcvc3RhcnRPZkJ1c2luZXNzS2V5JywgZGF0YSkudGhlbigoeyBkYXRhOiByZXMgfSkgPT4gewogICAgICAgIGlmIChyZXMuY29kZSAhPT0gMCkgewogICAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2tzLnN0YXJ0UHJvY2Vzc0Vycm9yQ2FsbGJhY2spIHsKICAgICAgICAgICAgdGhpcy5jYWxsYmFja3Muc3RhcnRQcm9jZXNzRXJyb3JDYWxsYmFjayhyZXMuZGF0YSkKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICBtZXNzYWdlOiB0aGlzLiR0KCdwcm9tcHQuc3VjY2VzcycpLAogICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLAogICAgICAgICAgZHVyYXRpb246IDUwMCwKICAgICAgICAgIG9uQ2xvc2U6ICgpID0+IHsKICAgICAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2tzLnN0YXJ0UHJvY2Vzc1N1Y2Nlc3NDYWxsYmFjaykgewogICAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tzLnN0YXJ0UHJvY2Vzc1N1Y2Nlc3NDYWxsYmFjayhyZXMuZGF0YSkKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0pCiAgICAgICAgaWYgKHRoaXMuaW5zdGFuY2VJZFVybCkgewogICAgICAgICAgdmFyIHBhcmFtcyA9IHFzLnN0cmluZ2lmeSh7CiAgICAgICAgICAgIHByb2Nlc3NJbnN0YW5jZUlkOiByZXMuZGF0YS5wcm9jZXNzSW5zdGFuY2VJZCwKICAgICAgICAgICAgcHJvY2Vzc0RlZmluaXRpb25LZXk6IHByb2Nlc3NEZWZpbml0aW9uS2V5LAogICAgICAgICAgICBidXNpbmVzc0tleTogYnVzaW5lc3NLZXkKICAgICAgICAgIH0pCiAgICAgICAgICB0aGlzLiRodHRwWydwb3N0J10odGhpcy5pbnN0YW5jZUlkVXJsICsgJz8nICsgcGFyYW1zKS50aGVuKCh7IGRhdGE6IHJlcyB9KSA9PiB7fSkKICAgICAgICB9CiAgICAgIH0pLmNhdGNoKCgpID0+IHt9KQogICAgfQogIH0KfQo="},{"version":3,"sources":["ren-process-start.vue"],"names":[],"mappings":";;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ren-process-start.vue","sourceRoot":"src/components/ren-process-start/src","sourcesContent":["<template>\n  <el-button type=\"primary\" @click=\"processStartHandle()\">{{ $t('process.createInstance') }}</el-button>\n</template>\n\n<script>\nimport qs from 'qs'\nexport default {\n  name: 'RenProcessStart',\n  data () {\n    return {\n      formUrl: '',\n      instanceIdUrl: '',\n      formName: null,\n      rootObj: null,\n      dataForm: {\n        processDefinitionKey: ''\n      },\n      // 回调函数\n      callbacks: {\n        startProcessSuccessCallback: null,\n        startProcessErrorCallback: null,\n        formSaveSuccessCallback: null,\n        formSaveErrorCallback: null\n      }\n    }\n  },\n  components: {\n  },\n  created () {\n    this.$nextTick(() => {\n      this.formUrl = this.saveFormUrl\n      this.instanceIdUrl = this.updateInstanceIdUrl\n      this.formName = this.dataFormName\n    })\n  },\n  props: {\n    saveFormUrl: String,\n    updateInstanceIdUrl: String,\n    dataFormName: String\n  },\n  watch: {\n    saveFormUrl (val) {\n      this.formUrl = val\n    },\n    updateInstanceIdUrl (val) {\n      this.instanceIdUrl = val\n    },\n    dataFormName (val) {\n      this.formName = val\n    }\n  },\n  methods: {\n    // 启动流程事件\n    processStartHandle () {\n      if (!this.formUrl) {\n        return this.$message.error(this.$t('process.formURLError'))\n      }\n      if (!this.dataForm.processDefinitionKey) {\n        return this.$message.error(this.$t('process.keyError'))\n      }\n      if (!this.formName) {\n        return this.$message.error(this.$t('process.formNameError'))\n      }\n      this.rootObj.$refs[this.formName].validate((valid) => {\n        if (!valid) {\n          return false\n        }\n        this.$http.get(`/act/process/lastestPage`, {\n          params: {\n            key: this.dataForm.processDefinitionKey\n          }\n        }).then(({ data: res }) => {\n          if (res.code !== 0) {\n            return this.$message.error(res.msg)\n          }\n          if (!res.data.list || res.data.list.length <= 0) {\n            return this.$message.error(this.$t('process.notExistError'))\n          }\n          this.$http['post'](this.formUrl, this.rootObj[this.formName]).then(({ data: res }) => {\n            if (res.code !== 0) {\n              this.$message.error(res.msg)\n              if (this.callbacks.formSaveErrorCallback) {\n                this.callbacks.formSaveErrorCallback(res)\n              }\n            }\n            if (this.callbacks.formSaveSuccessCallback) {\n              this.callbacks.formSaveSuccessCallback(res)\n            }\n            if (!res.data.businessKey) {\n              return this.$message.error(this.$t('process.businessKeyError'))\n              // this.startProcess(this.dataForm.processDefinitionKey, null, this.rootObj[this.formName])\n            } else {\n              this.startProcess(this.dataForm.processDefinitionKey, res.data.businessKey, this.rootObj[this.formName])\n            }\n          }).catch(() => {})\n        }).catch(() => {})\n      })\n    },\n    // 启动流程\n    startProcess (processDefinitionKey, businessKey, formData) {\n      var data = {\n        processDefinitionKey: processDefinitionKey,\n        businessKey: businessKey,\n        variables: formData\n      }\n      this.$http['post']('/act/running/startOfBusinessKey', data).then(({ data: res }) => {\n        if (res.code !== 0) {\n          if (this.callbacks.startProcessErrorCallback) {\n            this.callbacks.startProcessErrorCallback(res.data)\n          }\n        }\n        this.$message({\n          message: this.$t('prompt.success'),\n          type: 'success',\n          duration: 500,\n          onClose: () => {\n            if (this.callbacks.startProcessSuccessCallback) {\n              this.callbacks.startProcessSuccessCallback(res.data)\n            }\n          }\n        })\n        if (this.instanceIdUrl) {\n          var params = qs.stringify({\n            processInstanceId: res.data.processInstanceId,\n            processDefinitionKey: processDefinitionKey,\n            businessKey: businessKey\n          })\n          this.$http['post'](this.instanceIdUrl + '?' + params).then(({ data: res }) => {})\n        }\n      }).catch(() => {})\n    }\n  }\n}\n</script>\n"]}]}