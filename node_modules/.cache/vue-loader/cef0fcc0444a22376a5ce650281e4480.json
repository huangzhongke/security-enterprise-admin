{"remainingRequest":"E:\\frontCode\\security-enterprise-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\frontCode\\security-enterprise-admin\\src\\components\\ren-process-running\\src\\ren-task-handle.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\frontCode\\security-enterprise-admin\\src\\components\\ren-process-running\\src\\ren-task-handle.vue","mtime":1657251814285},{"path":"E:\\frontCode\\security-enterprise-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1657251795729},{"path":"E:\\frontCode\\security-enterprise-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":1657251794312},{"path":"E:\\frontCode\\security-enterprise-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1657251795729},{"path":"E:\\frontCode\\security-enterprise-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1657251812566}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgZGVib3VuY2UgZnJvbSAnbG9kYXNoL2RlYm91bmNlJw0KaW1wb3J0IHFzIGZyb20gJ3FzJw0KZXhwb3J0IGRlZmF1bHQgew0KICBkYXRhICgpIHsNCiAgICByZXR1cm4gew0KICAgICAgdmlzaWJsZTogZmFsc2UsDQogICAgICBoYW5kbGVUeXBlOiAnJywNCiAgICAgIGhhbmRsZVRpdGxlOiAnJywNCiAgICAgIGRhdGFGb3JtOiB7DQogICAgICAgIGNvbW1lbnQ6ICcnLA0KICAgICAgICB0YXNrSWQ6ICcnDQogICAgICB9LA0KICAgICAgLy8g5Zue6LCD5Ye95pWwDQogICAgICBjYWxsYmFja3M6IHsNCiAgICAgICAgdGFza0hhbmRsZVN1Y2Nlc3NDYWxsYmFjazogbnVsbCwNCiAgICAgICAgdGFza0hhbmRsZUVycm9yQ2FsbGJhY2s6IG51bGwNCiAgICAgIH0NCiAgICB9DQogIH0sDQogIGNvbXB1dGVkOiB7DQogICAgZGF0YVJ1bGUgKCkgew0KICAgICAgcmV0dXJuIHsNCiAgICAgICAgY29tbWVudDogWw0KICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6IHRoaXMuJHQoJ3ZhbGlkYXRlLnJlcXVpcmVkJyksIHRyaWdnZXI6ICdibHVyJyB9DQogICAgICAgIF0NCiAgICAgIH0NCiAgICB9DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBpbml0ICgpIHsNCiAgICAgIHRoaXMudmlzaWJsZSA9IHRydWUNCiAgICAgIGlmICh0aGlzLmhhbmRsZVR5cGUgPT09ICdjb21wbGV0ZScpIHsNCiAgICAgICAgdGhpcy5oYW5kbGVUaXRsZSA9IHRoaXMuJHQoJ3Byb2Nlc3MuY29tcGxldGVUYXNrJykNCiAgICAgIH0gZWxzZSBpZiAodGhpcy5oYW5kbGVUeXBlID09PSAncmVqZWN0Jykgew0KICAgICAgICB0aGlzLmhhbmRsZVRpdGxlID0gdGhpcy4kdCgncHJvY2Vzcy5yZWplY3RUYXNrJykNCiAgICAgIH0gZWxzZSBpZiAodGhpcy5oYW5kbGVUeXBlID09PSAndGVybWluYXRpb24nKSB7DQogICAgICAgIHRoaXMuaGFuZGxlVGl0bGUgPSB0aGlzLiR0KCdwcm9jZXNzLnRlcm1pbmF0aW9uVGFzaycpDQogICAgICB9DQogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7DQogICAgICAgIHRoaXMuJHJlZnNbJ2RhdGFGb3JtJ10ucmVzZXRGaWVsZHMoKQ0KICAgICAgfSkNCiAgICB9LA0KICAgIC8vIOihqOWNleaPkOS6pA0KICAgIGRhdGFGb3JtU3VibWl0SGFuZGxlICgpIHsNCiAgICAgIGlmICh0aGlzLmhhbmRsZVR5cGUgPT09ICdjb21wbGV0ZScpIHsNCiAgICAgICAgdGhpcy5jb21wbGV0ZVRhc2soKQ0KICAgICAgfSBlbHNlIGlmICh0aGlzLmhhbmRsZVR5cGUgPT09ICdyZWplY3QnKSB7DQogICAgICAgIHRoaXMucmVqZWN0VGFzaygpDQogICAgICB9IGVsc2UgaWYgKHRoaXMuaGFuZGxlVHlwZSA9PT0gJ3Rlcm1pbmF0aW9uJykgew0KICAgICAgICB0aGlzLnRlcm1pbmF0aW9uVGFzaygpDQogICAgICB9DQogICAgfSwNCiAgICAvLyDpqbPlm54NCiAgICByZWplY3RUYXNrOiBkZWJvdW5jZShmdW5jdGlvbiAoKSB7DQogICAgICB0aGlzLiRyZWZzWydkYXRhRm9ybSddLnZhbGlkYXRlKCh2YWxpZCkgPT4gew0KICAgICAgICBpZiAoIXZhbGlkKSB7DQogICAgICAgICAgcmV0dXJuIGZhbHNlDQogICAgICAgIH0NCiAgICAgICAgaWYgKCF0aGlzLmRhdGFGb3JtLnRhc2tJZCkgew0KICAgICAgICAgIHJldHVybiBmYWxzZQ0KICAgICAgICB9DQogICAgICAgIHZhciBwYXJhbXMgPSBxcy5zdHJpbmdpZnkoew0KICAgICAgICAgICd0YXNrSWQnOiB0aGlzLmRhdGFGb3JtLnRhc2tJZCwNCiAgICAgICAgICAnY29tbWVudCc6IHRoaXMuZGF0YUZvcm0uY29tbWVudA0KICAgICAgICB9KQ0KICAgICAgICB0aGlzLiRodHRwWydwb3N0J10oJy9hY3QvdGFzay9iYWNrVG9GaXJzdD8nLCBwYXJhbXMpLnRoZW4oKHsgZGF0YTogcmVzIH0pID0+IHsNCiAgICAgICAgICBpZiAocmVzLmNvZGUgIT09IDApIHsNCiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IocmVzLm1zZykNCiAgICAgICAgICAgIGlmICh0aGlzLmNhbGxiYWNrcy50YXNrSGFuZGxlRXJyb3JDYWxsYmFjaykgew0KICAgICAgICAgICAgICB0aGlzLmNhbGxiYWNrcy50YXNrSGFuZGxlRXJyb3JDYWxsYmFjayhyZXMpDQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4NCiAgICAgICAgICB9DQogICAgICAgICAgdGhpcy4kbWVzc2FnZSh7DQogICAgICAgICAgICBtZXNzYWdlOiB0aGlzLiR0KCdwcm9tcHQuc3VjY2VzcycpLA0KICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLA0KICAgICAgICAgICAgZHVyYXRpb246IDUwMCwNCiAgICAgICAgICAgIG9uQ2xvc2U6ICgpID0+IHsNCiAgICAgICAgICAgICAgdGhpcy52aXNpYmxlID0gZmFsc2UNCiAgICAgICAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2tzLnRhc2tIYW5kbGVTdWNjZXNzQ2FsbGJhY2spIHsNCiAgICAgICAgICAgICAgICB0aGlzLmNhbGxiYWNrcy50YXNrSGFuZGxlU3VjY2Vzc0NhbGxiYWNrKHJlcykNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0pDQogICAgICAgIH0pDQogICAgICB9KQ0KICAgIH0sIDEwMDAsIHsgJ2xlYWRpbmcnOiB0cnVlLCAndHJhaWxpbmcnOiBmYWxzZSB9KSwNCiAgICAvLyDpgJrov4cNCiAgICBjb21wbGV0ZVRhc2s6IGRlYm91bmNlKGZ1bmN0aW9uICgpIHsNCiAgICAgIHRoaXMuJHJlZnNbJ2RhdGFGb3JtJ10udmFsaWRhdGUoKHZhbGlkKSA9PiB7DQogICAgICAgIGlmICghdmFsaWQpIHsNCiAgICAgICAgICByZXR1cm4gZmFsc2UNCiAgICAgICAgfQ0KICAgICAgICBpZiAoIXRoaXMuZGF0YUZvcm0udGFza0lkKSB7DQogICAgICAgICAgcmV0dXJuIGZhbHNlDQogICAgICAgIH0NCiAgICAgICAgdmFyIHBhcmFtcyA9IHFzLnN0cmluZ2lmeSh7DQogICAgICAgICAgJ3Rhc2tJZCc6IHRoaXMuZGF0YUZvcm0udGFza0lkLA0KICAgICAgICAgICdjb21tZW50JzogdGhpcy5kYXRhRm9ybS5jb21tZW50DQogICAgICAgIH0pDQogICAgICAgIHRoaXMuJGh0dHAucG9zdCgnL2FjdC90YXNrL2NvbXBsZXRlPycgKyBwYXJhbXMpLnRoZW4oKHsgZGF0YTogcmVzIH0pID0+IHsNCiAgICAgICAgICBpZiAocmVzLmNvZGUgIT09IDApIHsNCiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IocmVzLm1zZykNCiAgICAgICAgICAgIGlmICh0aGlzLmNhbGxiYWNrcy50YXNrSGFuZGxlRXJyb3JDYWxsYmFjaykgew0KICAgICAgICAgICAgICB0aGlzLmNhbGxiYWNrcy50YXNrSGFuZGxlRXJyb3JDYWxsYmFjayhyZXMpDQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4NCiAgICAgICAgICB9DQogICAgICAgICAgdGhpcy4kbWVzc2FnZSh7DQogICAgICAgICAgICBtZXNzYWdlOiB0aGlzLiR0KCdwcm9tcHQuc3VjY2VzcycpLA0KICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLA0KICAgICAgICAgICAgZHVyYXRpb246IDUwMCwNCiAgICAgICAgICAgIG9uQ2xvc2U6ICgpID0+IHsNCiAgICAgICAgICAgICAgdGhpcy52aXNpYmxlID0gZmFsc2UNCiAgICAgICAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2tzLnRhc2tIYW5kbGVTdWNjZXNzQ2FsbGJhY2spIHsNCiAgICAgICAgICAgICAgICB0aGlzLmNhbGxiYWNrcy50YXNrSGFuZGxlU3VjY2Vzc0NhbGxiYWNrKHJlcykNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0pDQogICAgICAgIH0pLmNhdGNoKCgpID0+IHt9KQ0KICAgICAgfSkNCiAgICB9LCAxMDAwLCB7ICdsZWFkaW5nJzogdHJ1ZSwgJ3RyYWlsaW5nJzogZmFsc2UgfSksDQogICAgLy8g57uI5q2iDQogICAgdGVybWluYXRpb25UYXNrOiBkZWJvdW5jZShmdW5jdGlvbiAoKSB7DQogICAgICB0aGlzLiRyZWZzWydkYXRhRm9ybSddLnZhbGlkYXRlKCh2YWxpZCkgPT4gew0KICAgICAgICBpZiAoIXZhbGlkKSB7DQogICAgICAgICAgcmV0dXJuIGZhbHNlDQogICAgICAgIH0NCiAgICAgICAgaWYgKCF0aGlzLmRhdGFGb3JtLnRhc2tJZCkgew0KICAgICAgICAgIHJldHVybiBmYWxzZQ0KICAgICAgICB9DQogICAgICAgIHZhciB0YXNrID0gcXMuc3RyaW5naWZ5KHsNCiAgICAgICAgICB0YXNrSWQ6IHRoaXMuZGF0YUZvcm0udGFza0lkLA0KICAgICAgICAgIGNvbW1lbnQ6IHRoaXMuZGF0YUZvcm0uY29tbWVudA0KICAgICAgICB9KQ0KICAgICAgICB0aGlzLiRodHRwWydwb3N0J10oJy9hY3QvdGFzay9lbmRQcm9jZXNzJywgdGFzaykudGhlbigoeyBkYXRhOiByZXMgfSkgPT4gew0KICAgICAgICAgIGlmIChyZXMuY29kZSAhPT0gMCkgew0KICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihyZXMubXNnKQ0KICAgICAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2tzLnRhc2tIYW5kbGVFcnJvckNhbGxiYWNrKSB7DQogICAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tzLnRhc2tIYW5kbGVFcnJvckNhbGxiYWNrKHJlcykNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybg0KICAgICAgICAgIH0NCiAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICAgIG1lc3NhZ2U6IHRoaXMuJHQoJ3Byb21wdC5zdWNjZXNzJyksDQogICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycsDQogICAgICAgICAgICBkdXJhdGlvbjogNTAwLA0KICAgICAgICAgICAgb25DbG9zZTogKCkgPT4gew0KICAgICAgICAgICAgICB0aGlzLnZpc2libGUgPSBmYWxzZQ0KICAgICAgICAgICAgICBpZiAodGhpcy5jYWxsYmFja3MudGFza0hhbmRsZVN1Y2Nlc3NDYWxsYmFjaykgew0KICAgICAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tzLnRhc2tIYW5kbGVTdWNjZXNzQ2FsbGJhY2socmVzKQ0KICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgfSkNCiAgICAgICAgfSkuY2F0Y2goKCkgPT4ge30pDQogICAgICB9KQ0KICAgIH0sIDEwMDAsIHsgJ2xlYWRpbmcnOiB0cnVlLCAndHJhaWxpbmcnOiBmYWxzZSB9KQ0KICB9DQp9DQo="},{"version":3,"sources":["ren-task-handle.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;AAeA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ren-task-handle.vue","sourceRoot":"src/components/ren-process-running/src","sourcesContent":["<template>\r\n  <el-dialog :visible.sync=\"visible\" :title=\"handleTitle\" :close-on-click-modal=\"false\" :close-on-press-escape=\"false\">\r\n    <el-form :model=\"dataForm\" :rules=\"dataRule\" ref=\"dataForm\" @keyup.enter.native=\"dataFormSubmitHandle()\" :label-width=\"$i18n.locale === 'en-US' ? '120px' : '80px'\">\r\n      <el-form-item :label=\"$t('process.comment')\" prop=\"comment\">\r\n        <el-input type=\"textarea\" v-model=\"dataForm.comment\" :placeholder=\"$t('process.comment')\"></el-input>\r\n      </el-form-item>\r\n    </el-form>\r\n    <template slot=\"footer\">\r\n      <el-button @click=\"visible = false\">{{ $t('cancel') }}</el-button>\r\n      <el-button type=\"primary\" @click=\"dataFormSubmitHandle()\">{{ $t('confirm') }}</el-button>\r\n    </template>\r\n  </el-dialog>\r\n</template>\r\n\r\n<script>\r\nimport debounce from 'lodash/debounce'\r\nimport qs from 'qs'\r\nexport default {\r\n  data () {\r\n    return {\r\n      visible: false,\r\n      handleType: '',\r\n      handleTitle: '',\r\n      dataForm: {\r\n        comment: '',\r\n        taskId: ''\r\n      },\r\n      // 回调函数\r\n      callbacks: {\r\n        taskHandleSuccessCallback: null,\r\n        taskHandleErrorCallback: null\r\n      }\r\n    }\r\n  },\r\n  computed: {\r\n    dataRule () {\r\n      return {\r\n        comment: [\r\n          { required: true, message: this.$t('validate.required'), trigger: 'blur' }\r\n        ]\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    init () {\r\n      this.visible = true\r\n      if (this.handleType === 'complete') {\r\n        this.handleTitle = this.$t('process.completeTask')\r\n      } else if (this.handleType === 'reject') {\r\n        this.handleTitle = this.$t('process.rejectTask')\r\n      } else if (this.handleType === 'termination') {\r\n        this.handleTitle = this.$t('process.terminationTask')\r\n      }\r\n      this.$nextTick(() => {\r\n        this.$refs['dataForm'].resetFields()\r\n      })\r\n    },\r\n    // 表单提交\r\n    dataFormSubmitHandle () {\r\n      if (this.handleType === 'complete') {\r\n        this.completeTask()\r\n      } else if (this.handleType === 'reject') {\r\n        this.rejectTask()\r\n      } else if (this.handleType === 'termination') {\r\n        this.terminationTask()\r\n      }\r\n    },\r\n    // 驳回\r\n    rejectTask: debounce(function () {\r\n      this.$refs['dataForm'].validate((valid) => {\r\n        if (!valid) {\r\n          return false\r\n        }\r\n        if (!this.dataForm.taskId) {\r\n          return false\r\n        }\r\n        var params = qs.stringify({\r\n          'taskId': this.dataForm.taskId,\r\n          'comment': this.dataForm.comment\r\n        })\r\n        this.$http['post']('/act/task/backToFirst?', params).then(({ data: res }) => {\r\n          if (res.code !== 0) {\r\n            this.$message.error(res.msg)\r\n            if (this.callbacks.taskHandleErrorCallback) {\r\n              this.callbacks.taskHandleErrorCallback(res)\r\n            }\r\n            return\r\n          }\r\n          this.$message({\r\n            message: this.$t('prompt.success'),\r\n            type: 'success',\r\n            duration: 500,\r\n            onClose: () => {\r\n              this.visible = false\r\n              if (this.callbacks.taskHandleSuccessCallback) {\r\n                this.callbacks.taskHandleSuccessCallback(res)\r\n              }\r\n            }\r\n          })\r\n        })\r\n      })\r\n    }, 1000, { 'leading': true, 'trailing': false }),\r\n    // 通过\r\n    completeTask: debounce(function () {\r\n      this.$refs['dataForm'].validate((valid) => {\r\n        if (!valid) {\r\n          return false\r\n        }\r\n        if (!this.dataForm.taskId) {\r\n          return false\r\n        }\r\n        var params = qs.stringify({\r\n          'taskId': this.dataForm.taskId,\r\n          'comment': this.dataForm.comment\r\n        })\r\n        this.$http.post('/act/task/complete?' + params).then(({ data: res }) => {\r\n          if (res.code !== 0) {\r\n            this.$message.error(res.msg)\r\n            if (this.callbacks.taskHandleErrorCallback) {\r\n              this.callbacks.taskHandleErrorCallback(res)\r\n            }\r\n            return\r\n          }\r\n          this.$message({\r\n            message: this.$t('prompt.success'),\r\n            type: 'success',\r\n            duration: 500,\r\n            onClose: () => {\r\n              this.visible = false\r\n              if (this.callbacks.taskHandleSuccessCallback) {\r\n                this.callbacks.taskHandleSuccessCallback(res)\r\n              }\r\n            }\r\n          })\r\n        }).catch(() => {})\r\n      })\r\n    }, 1000, { 'leading': true, 'trailing': false }),\r\n    // 终止\r\n    terminationTask: debounce(function () {\r\n      this.$refs['dataForm'].validate((valid) => {\r\n        if (!valid) {\r\n          return false\r\n        }\r\n        if (!this.dataForm.taskId) {\r\n          return false\r\n        }\r\n        var task = qs.stringify({\r\n          taskId: this.dataForm.taskId,\r\n          comment: this.dataForm.comment\r\n        })\r\n        this.$http['post']('/act/task/endProcess', task).then(({ data: res }) => {\r\n          if (res.code !== 0) {\r\n            this.$message.error(res.msg)\r\n            if (this.callbacks.taskHandleErrorCallback) {\r\n              this.callbacks.taskHandleErrorCallback(res)\r\n            }\r\n            return\r\n          }\r\n          this.$message({\r\n            message: this.$t('prompt.success'),\r\n            type: 'success',\r\n            duration: 500,\r\n            onClose: () => {\r\n              this.visible = false\r\n              if (this.callbacks.taskHandleSuccessCallback) {\r\n                this.callbacks.taskHandleSuccessCallback(res)\r\n              }\r\n            }\r\n          })\r\n        }).catch(() => {})\r\n      })\r\n    }, 1000, { 'leading': true, 'trailing': false })\r\n  }\r\n}\r\n</script>\r\n"]}]}