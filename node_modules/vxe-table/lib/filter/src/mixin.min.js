"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _xeUtils=_interopRequireDefault(require("xe-utils/methods/xe-utils")),_tools=require("../../tools"),_vXETable=_interopRequireDefault(require("../../v-x-e-table"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var _default={methods:{_filter:function(e,t){_tools.UtilTools.warn("vxe.error.delFunc",["filter","setFilter"]);var i=this.getColumnByField(e);if(i){var l=i.filters;if(l&&t){var r=t(l);return _xeUtils.default.isArray(r)&&(i.filters=_tools.UtilTools.getFilters(r)),this.$nextTick().then(function(){return l})}}return this.$nextTick()},_setFilter:function(e,t){return e.filters&&t&&(e.filters=_tools.UtilTools.getFilters(t)),this.$nextTick()},triggerFilterEvent:function(e,f,t){var n=this.$refs,a=this.filterStore;if(a.column===f&&a.visible)a.visible=!1;else{var u=n.tableBody.$el,c=e.target,h=e.pageX,d=_tools.DomTools.getDomNode().visibleWidth;Object.assign(a,{args:t,multiple:f.filterMultiple,options:f.filters,column:f,style:null,visible:!0}),a.isAllSelected=a.options.every(function(e){return e.checked}),a.isIndeterminate=!a.isAllSelected&&a.options.some(function(e){return e.checked}),this.hasFilterPanel=!0,this.$nextTick(function(){var e,t,i=n.filterWrapper.$el.offsetWidth,l=i/2,r={top:"".concat(c.offsetTop+c.offsetParent.offsetTop+c.offsetHeight+8,"px")};if("left"===f.fixed?e=c.offsetLeft+c.offsetParent.offsetLeft-l:"right"===f.fixed?t=c.offsetParent.offsetWidth-c.offsetLeft+(c.offsetParent.offsetParent.offsetWidth-c.offsetParent.offsetLeft)-f.renderWidth-l:e=c.offsetLeft+c.offsetParent.offsetLeft-l-u.scrollLeft,e){var s=h+i-l+32-d;0<s&&(e-=s),r.left="".concat(Math.max(32,e),"px")}else if(t){var o=h+i-l+32-d;0<o&&(t+=o),r.right="".concat(t,"px")}a.style=r})}},confirmFilterEvent:function(e){var t=this.visibleColumn,i=this.filterStore,l=this.remoteFilter,r=this.filterOpts,s=this.scrollXLoad,o=this.scrollYLoad,f=i.column,n=f.property,a=[],u=[];f.filters.forEach(function(e){e.checked&&(a.push(e.value),u.push(e.data))}),i.visible=!1,r.remote||l||(this.handleTableData(!0),this.checkSelectionStatus());var c=[];t.filter(function(e){var t=e.property,i=e.filters,l=[],r=[];i&&i.length&&(i.forEach(function(e){e.checked&&(l.push(e.value),r.push(e.data))}),c.push({column:e,property:t,field:t,prop:t,values:l,datas:r}))}),this.emitEvent("filter-change",{column:f,property:n,field:n,prop:n,values:a,datas:u,filters:c},e),this.updateFooter(),(s||o)&&(this.clearScroll(),o&&this.updateScrollYSpace()),this.closeFilter(),this.$nextTick(this.recalculate)},handleClearFilter:function(e){if(e){var t=e.filters,i=e.filterRender;if(t){t.forEach(function(e){e.checked=!1,e.data=_xeUtils.default.clone(e.resetValue,!0)});var l=i?_vXETable.default.renderer.get(i.name):null;l&&l.filterResetMethod&&l.filterResetMethod({options:t,column:e,$table:this})}}},resetFilterEvent:function(e){this.handleClearFilter(this.filterStore.column),this.confirmFilterEvent(e)},_clearFilter:function(e){arguments.length&&_xeUtils.default.isString(e)&&(e=this.getColumnByField(e));var t=this.filterStore;return e?this.handleClearFilter(e):this.visibleColumn.forEach(this.handleClearFilter),e&&e===t.column||Object.assign(t,{isAllSelected:!1,isIndeterminate:!1,style:null,options:[],column:null,multiple:!1,visible:!1}),this.updateData()}}};exports.default=_default;