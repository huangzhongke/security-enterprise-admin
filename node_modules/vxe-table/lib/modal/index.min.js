"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ModalController=ModalController,exports.default=exports.Modal=void 0;var _xeUtils=_interopRequireDefault(require("xe-utils/methods/xe-utils")),_modal=_interopRequireDefault(require("./src/modal")),_queue=_interopRequireDefault(require("./src/queue")),_vXETable=_interopRequireDefault(require("../v-x-e-table")),_tools=require("../tools");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var ModalClass=null,allActivedModals=[];function openModal(e){var r=Object.assign({},e,{transfer:!0});return new Promise(function(o){if(r&&r.id&&_queue.default.some(function(e){return e.id===r.id}))o("exist");else{var l=r.events||{};r.events=Object.assign({},l,{hide:function(e){l.hide&&l.hide.call(this,e),setTimeout(function(){return t.$destroy()},t.isMsg?500:100),_xeUtils.default.remove(allActivedModals,function(e){return e===t}),o(e.type)}});var t=new ModalClass({el:document.createElement("div"),propsData:r});allActivedModals.push(t),setTimeout(function(){t.isDestroy?_xeUtils.default.remove(allActivedModals,function(e){return e===t}):t.open()})}})}function ModalController(e){return _tools.UtilTools.warn("vxe.error.delFunc",["Modal","Modal.open"]),openModal(e)}function closeModal(e){return(arguments.length?[getModal(e)]:allActivedModals).forEach(function(e){e&&(e.isDestroy=!0,e.close("close"))}),Promise.resolve()}function getModal(o){return _xeUtils.default.find(allActivedModals,function(e){return e.id===o})}["alert","confirm","message"].forEach(function(r,a){var n=2===a?{mask:!1,lockView:!1,showHeader:!1}:{showFooter:!0};n.type=r,n.dblclickZoom=!1,1===a&&(n.status="question"),ModalController[r]=function(e,o,l){var t;return _xeUtils.default.isObject(e)?t=e:o&&(t=2===a?{status:o}:{title:o}),openModal(Object.assign({message:_xeUtils.default.toString(e),type:r},n,t,l))}}),ModalController.closeAll=function(){_tools.UtilTools.warn("vxe.error.delFunc",["closeAll","close"]),closeModal()},ModalController.get=getModal,ModalController.close=closeModal,ModalController.open=openModal,ModalController.install=function(e){_vXETable.default._modal=1,e.component("vxe-message",_modal.default),e.component(_modal.default.name,_modal.default),ModalClass=e.extend(_modal.default),e.prototype.$XMsg=ModalController,e.prototype.$XModal=ModalController,_vXETable.default.$modal=ModalController,_vXETable.default.modal=ModalController};var Modal=ModalController;exports.Modal=Modal;var _default=ModalController;exports.default=_default;