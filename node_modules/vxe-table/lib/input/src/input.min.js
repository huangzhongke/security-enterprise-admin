"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _xeUtils=_interopRequireDefault(require("xe-utils/methods/xe-utils")),_conf=_interopRequireDefault(require("../../conf")),_tools=require("../../tools");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var browse=_tools.DomTools.browse,wheelName=browse.firefox?"DOMMouseScroll":"mousewheel";function renderDefaultInput(e,t){var a=t.inpAttrs,i=t.inpEvents;return e("input",{ref:"input",class:"vxe-input--inner",domProps:{value:t.value},attrs:a,on:i})}function renderDateInput(e,t){var a=t.inpAttrs,i=t.inpEvents;return e("input",{ref:"input",class:"vxe-input--inner",domProps:{value:t.inputValue},attrs:a,on:i})}function renderDateLabel(e,t,a,i){var n=t.festivalMethod;if(n){var s=n({date:a.date}),l=s&&_xeUtils.default.isObject(s)?s:{label:s},r=[e("span",{class:["vxe-input--date-label",{"vxe-input--date-important":l.important}]},i)];return l.label&&r.push(e("span",{class:["vxe-input--date-festival",l.className]},l.label)),r}return i}function isDateDisabled(e,t){var a=e.disabledMethod||e.dateOpts.disabledMethod;return a&&a({date:t.date})}function renderDateDayTable(t,a){var e=a.datePanelType,i=a.dateValue,n=a.datePanelValue,s=a.dateHeaders,l=a.dayDatas,r="yyyy-MM-dd";return[t("table",{class:"vxe-input--date-".concat(e,"-view"),attrs:{cellspacing:0,cellpadding:0,border:0}},[t("thead",[t("tr",s.map(function(e){return t("th",e.label)}))]),t("tbody",l.map(function(e){return t("tr",e.map(function(e){return t("td",{class:{"is--prev":e.isPrev,"is--current":e.isCurrent,"is--today":e.isToday,"is--next":e.isNext,"is--disabled":isDateDisabled(a,e),"is--selected":_xeUtils.default.isDateSame(i,e.date,r),"is--hover":_xeUtils.default.isDateSame(n,e.date,r)},on:{click:function(){return a.dateSelectEvent(e)},mouseenter:function(){return a.dateMouseenterEvent(e)}}},renderDateLabel(t,a,e,e.label))}))}))])]}function renderDateWeekTable(i,n){var e=n.datePanelType,s=n.dateValue,l=n.datePanelValue,t=n.weekHeaders,a=n.weekDates,r="yyyy-MM-dd";return[i("table",{class:"vxe-input--date-".concat(e,"-view"),attrs:{cellspacing:0,cellpadding:0,border:0}},[i("thead",[i("tr",t.map(function(e){return i("th",e.label)}))]),i("tbody",a.map(function(e){var t=e.some(function(e){return _xeUtils.default.isDateSame(s,e.date,r)}),a=e.some(function(e){return _xeUtils.default.isDateSame(l,e.date,r)});return i("tr",e.map(function(e){return i("td",{class:{"is--prev":e.isPrev,"is--current":e.isCurrent,"is--today":e.isToday,"is--next":e.isNext,"is--disabled":isDateDisabled(n,e),"is--selected":t,"is--hover":a},on:{click:function(){return n.dateSelectEvent(e)},mouseenter:function(){return n.dateMouseenterEvent(e)}}},renderDateLabel(i,n,e,e.label))}))}))])]}function renderDateMonthTable(t,a){var i=a.dateValue,e=a.datePanelType,n=a.monthDatas,s=a.datePanelValue,l="yyyy-MM";return[t("table",{class:"vxe-input--date-".concat(e,"-view"),attrs:{cellspacing:0,cellpadding:0,border:0}},[t("tbody",n.map(function(e){return t("tr",e.map(function(e){return t("td",{class:{"is--prev":e.isPrev,"is--current":e.isCurrent,"is--next":e.isNext,"is--disabled":isDateDisabled(a,e),"is--selected":_xeUtils.default.isDateSame(i,e.date,l),"is--hover":_xeUtils.default.isDateSame(s,e.date,l)},on:{click:function(){return a.dateSelectEvent(e)},mouseenter:function(){return a.dateMouseenterEvent(e)}}},renderDateLabel(t,a,e,_conf.default.i18n("vxe.input.date.months.m".concat(e.month))))}))}))])]}function renderDateYearTable(t,a){var i=a.dateValue,e=a.datePanelType,n=a.yearDatas,s=a.datePanelValue;return[t("table",{class:"vxe-input--date-".concat(e,"-view"),attrs:{cellspacing:0,cellpadding:0,border:0}},[t("tbody",n.map(function(e){return t("tr",e.map(function(e){return t("td",{class:{"is--disabled":isDateDisabled(a,e),"is--selected":_xeUtils.default.isDateSame(i,e.date,"yyyy"),"is--hover":_xeUtils.default.isDateSame(s,e.date,"yyyy")},on:{click:function(){return a.dateSelectEvent(e)},mouseenter:function(){return a.dateMouseenterEvent(e)}}},renderDateLabel(t,a,e,e.year))}))}))])]}function renderDateTable(e,t){switch(t.datePanelType){case"week":return renderDateWeekTable(e,t);case"month":return renderDateMonthTable(e,t);case"year":return renderDateYearTable(e,t)}return renderDateDayTable(e,t)}function rendeDatePanel(e,t){var a=t.datePanelType,i=t.selectDatePanelLabel;return[e("div",{class:"vxe-input--date-picker-header"},[e("div",{class:"vxe-input--date-picker-type-wrapper"},[e("span","year"===a?{class:"vxe-input--date-picker-label"}:{class:"vxe-input--date-picker-btn",on:{click:t.dateToggleTypeEvent}},i)]),e("div",{class:"vxe-input--date-picker-btn-wrapper"},[e("span",{class:"vxe-input--date-picker-btn vxe-input--date-picker-prev-btn",attrs:{title:_conf.default.i18n("vxe.input.date.prevMonth")},on:{click:t.datePrevEvent}},[e("i",{class:"vxe-icon--caret-left"})]),e("span",{class:"vxe-input--date-picker-btn vxe-input--date-picker-current-btn",attrs:{title:_conf.default.i18n("vxe.input.date.today")},on:{click:t.dateTodayMonthEvent}},[e("i",{class:"vxe-icon--dot"})]),e("span",{class:"vxe-input--date-picker-btn vxe-input--date-picker-next-btn",attrs:{title:_conf.default.i18n("vxe.input.date.nextMonth")},on:{click:t.dateNextEvent}},[e("i",{class:"vxe-icon--caret-right"})])])]),e("div",{class:"vxe-input--date-picker-body"},renderDateTable(e,t))]}function rendeTimePanel(a,i){var e=i.dateTimeLabel,n=i.datetimePanelValue,t=i.hourList,s=i.minuteList,l=i.secondList;return[a("div",{class:"vxe-input--time-picker-header"},[a("span",{class:"vxe-input--time-picker-title"},e),a("button",{class:"vxe-input--time-picker-confirm",attrs:{type:"button"},on:{click:i.dateConfirmEvent}},_conf.default.i18n("vxe.button.confirm"))]),a("div",{ref:"timeBody",class:"vxe-input--time-picker-body"},[a("ul",{class:"vxe-input--time-picker-hour-list"},t.map(function(t,e){return a("li",{key:e,class:{"is--selected":n&&n.getHours()===t.value},on:{click:function(e){return i.dateHourEvent(e,t)}}},t.label)})),a("ul",{class:"vxe-input--time-picker-minute-list"},s.map(function(t,e){return a("li",{key:e,class:{"is--selected":n&&n.getMinutes()===t.value},on:{click:function(e){return i.dateMinuteEvent(e,t)}}},t.label)})),a("ul",{class:"vxe-input--time-picker-second-list"},l.map(function(t,e){return a("li",{key:e,class:{"is--selected":n&&n.getSeconds()===t.value},on:{click:function(e){return i.dateSecondEvent(e,t)}}},t.label)}))])]}function renderPanel(e,t){var a,i=t.type,n=t.vSize,s=t.isDatePicker,l=t.transfer,r=t.animatVisible,u=t.visiblePanel,o=t.panelPlacement,d=t.panelStyle;return s?e("div",{ref:"panel",class:["vxe-table--ignore-clear vxe-input--panel","type--".concat(i),(a={},_defineProperty(a,"size--".concat(n),n),_defineProperty(a,"is--transfer",l),_defineProperty(a,"animat--leave",r),_defineProperty(a,"animat--enter",u),a)],attrs:{"data-placement":o},style:d},["datetime"===i?e("div",{class:"vxe-input--panel-layout-wrapper"},[e("div",{class:"vxe-input--panel-left-wrapper"},rendeDatePanel(e,t)),e("div",{class:"vxe-input--panel-right-wrapper"},rendeTimePanel(e,t))]):e("div",{class:"vxe-input--panel-wrapper"},rendeDatePanel(e,t))]):null}function renderNumberIcon(e,t){return e("span",{class:"vxe-input--number-suffix"},[e("span",{class:"vxe-input--number-prev is--prev",on:{mousedown:t.numberMousedownEvent,mouseup:t.numberStopDown,mouseleave:t.numberStopDown}},[e("i",{class:["vxe-input--number-prev-icon",_conf.default.icon.INPUT_PREV_NUM]})]),e("span",{class:"vxe-input--number-next is--next",on:{mousedown:t.numberMousedownEvent,mouseup:t.numberStopDown,mouseleave:t.numberStopDown}},[e("i",{class:["vxe-input--number-next-icon",_conf.default.icon.INPUT_NEXT_NUM]})])])}function renderDatePickerIcon(e,t){return e("span",{class:"vxe-input--date-picker-suffix",on:{click:t.datePickerOpenEvent}},[e("i",{class:["vxe-input--date-picker-icon",_conf.default.icon.INPUT_DATE]})])}function renderSearchIcon(e,t){return e("span",{class:"vxe-input--search-suffix",on:{click:t.searchEvent}},[e("i",{class:["vxe-input--search-icon",_conf.default.icon.INPUT_SEARCH]})])}function renderPasswordIcon(e,t){var a=t.showPwd;return e("span",{class:"vxe-input--password-suffix",on:{click:t.passwordToggleEvent}},[e("i",{class:["vxe-input--password-icon",a?_conf.default.icon.INPUT_SHOW_PWD:_conf.default.icon.INPUT_PWD]})])}function rendePrefixIcon(e,t){var a=t.$scopedSlots,i=t.prefixIcon,n=[];return a.prefix?n.push(e("span",{class:"vxe-input--prefix-icon"},a.prefix.call(this,{},e))):i&&n.push(e("i",{class:["vxe-input--prefix-icon",i]})),n.length?e("span",{class:"vxe-input--prefix",on:{click:t.clickPrefixEvent}},n):null}function renderSuffixIcon(e,t){var a=t.$scopedSlots,i=t.value,n=t.isClearable,s=t.disabled,l=t.suffixIcon,r=[];return a.suffix?r.push(e("span",{class:"vxe-input--suffix-icon"},a.suffix.call(this,{},e))):l&&r.push(e("i",{class:["vxe-input--suffix-icon",l]})),n&&r.push(e("i",{class:["vxe-input--clear-icon",_conf.default.icon.INPUT_CLEAR]})),r.length?e("span",{class:["vxe-input--suffix",{"is--clear":n&&!s&&!(""===i||_xeUtils.default.eqNull(i))}],on:{click:t.clickSuffixEvent}},r):null}function renderExtraSuffixIcon(e,t){var a,i=t.isPassword,n=t.isNumber,s=t.isDatePicker,l=t.isSearch;return i?a=renderPasswordIcon(e,t):n?a=renderNumberIcon(e,t):s?a=renderDatePickerIcon(e,t):l&&(a=renderSearchIcon(e,t)),a?e("span",{class:"vxe-input--extra-suffix"},[a]):null}var _default2={name:"VxeInput",props:{value:[String,Number,Date],name:String,type:{type:String,default:"text"},clearable:{type:Boolean,default:function(){return _conf.default.input.clearable}},readonly:Boolean,disabled:Boolean,placeholder:String,maxlength:[String,Number],autocomplete:{type:String,default:"off"},form:String,size:{type:String,default:function(){return _conf.default.input.size||_conf.default.size}},min:{type:[String,Number],default:null},max:{type:[String,Number],default:null},step:[String,Number],digits:{type:[String,Number],default:function(){return _conf.default.input.digits}},dateConfig:Object,startWeek:{type:Number,default:function(){return _conf.default.input.startWeek}},labelFormat:{type:String,default:function(){return _conf.default.input.labelFormat}},parseFormat:{type:String,default:function(){return _conf.default.input.parseFormat}},valueFormat:{type:String,default:function(){return _conf.default.input.valueFormat}},editable:{type:Boolean,default:!0},festivalMethod:{type:Function,default:function(){return _conf.default.input.festivalMethod}},disabledMethod:{type:Function,default:function(){return _conf.default.input.disabledMethod}},prefixIcon:String,suffixIcon:String,placement:String,transfer:{type:Boolean,default:function(){return _conf.default.input.transfer}}},data:function(){return{panelIndex:0,showPwd:!1,visiblePanel:!1,animatVisible:!1,panelStyle:null,panelPlacement:null,isActivated:!1,inputValue:"",datetimePanelValue:null,datePanelValue:null,datePanelLabel:"",datePanelType:"day",selectMonth:null,currentDate:null}},computed:{vSize:function(){return this.size||this.$parent.size||this.$parent.vSize},isNumber:function(){return-1<["number","integer","float"].indexOf(this.type)},isDatePicker:function(){return-1<["date","datetime","week","month","year"].indexOf(this.type)},isPassword:function(){return"password"===this.type},isSearch:function(){return"search"===this.type},stepValue:function(){var e=this.type,t=this.step;return"integer"===e?_xeUtils.default.toInteger(t)||1:"float"===e?_xeUtils.default.toNumber(t)||1/Math.pow(10,_xeUtils.default.toInteger(this.digits)||1):_xeUtils.default.toNumber(t)||1},isClearable:function(){return this.clearable&&(this.isPassword||this.isNumber||this.isDatePicker||"text"===this.type||"search"===this.type)},dateValue:function(){var e=this.value;return e?_xeUtils.default.toStringDate(e,this.dateValueFormat):null},dateTimeLabel:function(){var e=this.datetimePanelValue;return e?_xeUtils.default.toDateString(e,"HH:mm:ss"):""},hmsTime:function(){var e=this.type,t=this.dateValue;return t&&"datetime"===e?1e3*(3600*t.getHours()+60*t.getMinutes()+t.getSeconds()):0},dateLabelFormat:function(){return this.isDatePicker?this.labelFormat||this.dateOpts.labelFormat||_conf.default.i18n("vxe.input.date.labelFormat.".concat(this.type)):null},dateValueFormat:function(){return this.valueFormat||this.dateOpts.valueFormat||("datetime"===this.type?"yyyy-MM-dd HH:mm:ss":"yyyy-MM-dd")},selectDatePanelLabel:function(){var e,t=this.datePanelType,a=this.selectMonth,i=this.yearList,n="";return a&&(n=a.getFullYear(),e=a.getMonth()+1),"month"===t?_xeUtils.default.template(_conf.default.i18n("vxe.input.date.monthLabel"),[n]):"year"===t?i.length?"".concat(i[0].year," - ").concat(i[i.length-1].year):"":_xeUtils.default.template(_conf.default.i18n("vxe.input.date.dayLabel"),[n,e?_conf.default.i18n("vxe.input.date.m".concat(e)):"-"])},weekDatas:function(){for(var e=_xeUtils.default.toNumber(_xeUtils.default.isNumber(this.startWeek)?this.startWeek:this.dateOpts.startWeek),t=[e],a=0;a<6;a++)6<=e?e=0:e++,t.push(e);return t},dateHeaders:function(){return this.weekDatas.map(function(e){return{value:e,label:_conf.default.i18n("vxe.input.date.weeks.w".concat(e))}})},weekHeaders:function(){return[{label:_conf.default.i18n("vxe.input.date.weeks.w")}].concat(this.dateHeaders)},yearList:function(){var e=this.selectMonth,t=[];if(e)for(var a=0;a<16;a++){var i=_xeUtils.default.getWhatYear(e,a,"first");t.push({date:i,year:i.getFullYear()})}return t},yearDatas:function(){return _xeUtils.default.chunk(this.yearList,4)},monthList:function(){var e=this.selectMonth,t=[];if(e)for(var a=_xeUtils.default.getWhatYear(e,0,"first").getFullYear(),i=0;i<16;i++){var n=_xeUtils.default.getWhatYear(e,0,i),s=n.getMonth(),l=n.getFullYear(),r=l<a;t.push({date:n,isPrev:r,isCurrent:l===a,isNext:!r&&a<l,month:s})}return t},monthDatas:function(){return _xeUtils.default.chunk(this.monthList,4)},dayList:function(){var e=this.weekDatas,t=this.selectMonth,a=this.currentDate,i=this.hmsTime,n=[];if(t&&a)for(var s=t.getMonth(),l=t.getDay(),r=-e.indexOf(l),u=new Date(_xeUtils.default.getWhatDay(t,r).getTime()+i),o=0;o<42;o++){var d=_xeUtils.default.getWhatDay(u,o),h=d<t;n.push({date:d,isPrev:h,isCurrent:d.getFullYear()===t.getFullYear()&&d.getMonth()===t.getMonth(),isToday:d.getFullYear()===a.getFullYear()&&d.getMonth()===a.getMonth()&&d.getDate()===a.getDate(),isNext:!h&&s!==d.getMonth(),label:d.getDate()})}return n},dayDatas:function(){return _xeUtils.default.chunk(this.dayList,7)},weekDates:function(){return this.dayDatas.map(function(e){var t=e[0];return[{date:t.date,isPrev:!1,isCurrent:!1,isToday:!1,isNext:!1,label:_xeUtils.default.getYearWeek(t.date)}].concat(e)})},dateOpts:function(){return Object.assign({},this.dateConfig,_conf.default.input.dateConfig)},hourList:function(){for(var e=[],t=0;t<24;t++)e.push({value:t,label:(""+t).padStart(2,0)});return e},minuteList:function(){for(var e=[],t=0;t<60;t++)e.push({value:t,label:(""+t).padStart(2,0)});return e},secondList:function(){return this.minuteList},inpAttrs:function(){var e=this.isDatePicker,t=this.isNumber,a=this.isPassword,i=this.type,n=this.name,s=this.placeholder,l=this.readonly,r=this.disabled,u=this.maxlength,o=this.form,d=this.autocomplete,h=this.showPwd,c=this.editable,f=i;(e||t||a&&h||"number"===i)&&(f="text");var p={name:n,form:o,type:f,placeholder:s,maxlength:t?16:u,readonly:l||"week"===i||!c||!1===this.dateOpts.editable,disabled:r,autocomplete:d};return s&&(p.placeholder=_tools.UtilTools.getFuncText(s)),p},inpEvents:function(){var a=this,i={};return _xeUtils.default.each(this.$listeners,function(e,t){-1===["change","clear","prefix-click","suffix-click"].indexOf(t)&&(i[t]=a.triggerEvent)}),this.isNumber?(i.keydown=this.keydownEvent,i[wheelName]=this.mousewheelEvent):this.isDatePicker&&(i.click=this.clickEvent),i.input=this.inputEvent,i.focus=this.focusEvent,i}},watch:{value:function(){this.changeValue()},dateLabelFormat:function(){this.dateParseValue(this.datePanelValue),this.inputValue=this.datePanelLabel}},created:function(){this.initValue(),_tools.GlobalEvent.on(this,"mousewheel",this.handleGlobalMousewheelEvent),_tools.GlobalEvent.on(this,"mousedown",this.handleGlobalMousedownEvent),_tools.GlobalEvent.on(this,"keydown",this.handleGlobalKeydownEvent),_tools.GlobalEvent.on(this,"blur",this.handleGlobalBlurEvent)},mounted:function(){this.dateConfig&&_tools.UtilTools.warn("vxe.error.removeProp",["date-config"]),this.isDatePicker&&this.transfer&&document.body.appendChild(this.$refs.panel)},beforeDestroy:function(){var e=this.$refs.panel;e&&e.parentNode&&e.parentNode.removeChild(e)},destroyed:function(){this.numberStopDown(),_tools.GlobalEvent.off(this,"mousewheel"),_tools.GlobalEvent.off(this,"mousedown"),_tools.GlobalEvent.off(this,"keydown"),_tools.GlobalEvent.off(this,"blur")},render:function(e){var t,a=this.isDatePicker,i=this.visiblePanel,n=this.isActivated,s=this.vSize,l=this.type,r=this.readonly,u=this.disabled,o=[],d=rendePrefixIcon(e,this),h=renderSuffixIcon(e,this);return d&&o.push(d),o.push(a?renderDateInput(e,this):renderDefaultInput(e,this)),h&&o.push(h),o.push(renderExtraSuffixIcon(e,this)),a&&o.push(renderPanel(e,this)),e("div",{class:["vxe-input","type--".concat(l),(t={},_defineProperty(t,"size--".concat(s),s),_defineProperty(t,"is--prefix",!!d),_defineProperty(t,"is--suffix",!!h),_defineProperty(t,"is--readonly",r),_defineProperty(t,"is--visivle",i),_defineProperty(t,"is--disabled",u),_defineProperty(t,"is--active",n),t)]},o)},methods:{focus:function(){return this.$refs.input.focus(),this.$nextTick()},blur:function(){return this.$refs.input.blur(),this.$nextTick()},triggerEvent:function(e){var t=this.$refs,a=this.value;this.$emit(e.type,{$panel:t.panel,value:a,$event:e},e)},emitUpdate:function(e,t){this.value!==e&&(this.$emit("input",e),this.$emit("change",{value:e,$event:t}))},inputEvent:function(e){var t=this.isDatePicker,a=e.target.value;this.inputValue=a,t||this.emitUpdate(a,e)},focusEvent:function(e){this.isActivated=!0,this.triggerEvent(e)},keydownEvent:function(e){if(this.isNumber){var t=e.ctrlKey,a=e.shiftKey,i=e.altKey,n=e.keyCode;t||a||i||!(32===n||65<=n&&n<=90)||e.preventDefault(),this.numberKeydownEvent(e)}this.triggerEvent(e)},mousewheelEvent:function(e){if(this.isNumber&&this.isActivated){var t=-e.wheelDelta||e.detail;0<t?this.numberNextEvent(e):t<0&&this.numberPrevEvent(e),e.preventDefault()}},clickEvent:function(e){this.isDatePicker&&this.datePickerOpenEvent(e),this.triggerEvent(e)},clickPrefixEvent:function(e){var t=this.$refs,a=this.disabled,i=this.value;a||this.$emit("prefix-click",{$panel:t.panel,value:i,$event:e},e)},clickSuffixEvent:function(e){var t=this.$refs,a=this.disabled,i=this.value;a||(_tools.DomTools.hasClass(e.currentTarget,"is--clear")?(this.emitUpdate("",e),this.clearValueEvent(e,"")):this.$emit("suffix-click",{$panel:t.panel,value:i,$event:e},e))},clearValueEvent:function(e,t){var a=this.$refs,i=this.type,n=this.isNumber;this.isDatePicker&&this.hidePanel(),(n||-1<["text","password"].indexOf(i))&&this.focus(),this.$emit("clear",{$panel:a.panel,value:t,$event:e},e)},initValue:function(){var e=this.type,t=this.isDatePicker,a=this.value,i=this.digits;if(t)this.changeValue();else if("float"===e&&a){var n=_xeUtils.default.toFixedString(a,_xeUtils.default.toNumber(i));a!==n&&this.emitUpdate(n,{type:"init"})}},changeValue:function(){this.isDatePicker&&(this.dateParseValue(this.value),this.inputValue=this.datePanelLabel)},afterCheckValue:function(){var e=this.type,t=this.inpAttrs,a=this.value,i=this.isDatePicker,n=this.isNumber,s=this.datetimePanelValue,l=this.dateLabelFormat,r=this.min,u=this.max,o=this.digits;if(!t.readonly)if(n){if(a){var d="integer"===e?_xeUtils.default.toInteger(a):_xeUtils.default.toNumber(a);this.vaildMinNum(d)?this.vaildMaxNum(d)||(d=u):d=r,this.emitUpdate("float"===e?_xeUtils.default.toFixedString(d,_xeUtils.default.toNumber(o)):""+d,{type:"check"})}}else if(i){var h=this.inputValue;h?(h=_xeUtils.default.toStringDate(h,l),_xeUtils.default.isDate(h)?_xeUtils.default.isDateSame(a,h,l)?this.inputValue=_xeUtils.default.toDateString(a,l):("datetime"===e&&(s.setHours(h.getHours()),s.setMinutes(h.getMinutes()),s.setSeconds(h.getSeconds())),this.dateChange(h)):this.dateRevert()):this.emitUpdate("",{type:"check"})}},passwordToggleEvent:function(e){var t=this.disabled,a=this.readonly,i=this.showPwd;t||a||(this.showPwd=!i),this.$emit("toggle-visible",{visible:this.showPwd,$event:e})},searchEvent:function(e){this.$emit("search-click",{$event:e})},vaildMinNum:function(e){return null===this.min||e>=_xeUtils.default.toNumber(this.min)},vaildMaxNum:function(e){return null===this.max||e<=_xeUtils.default.toNumber(this.max)},numberStopDown:function(){clearTimeout(this.downbumTimeout)},numberDownPrevEvent:function(e){var t=this;this.downbumTimeout=setTimeout(function(){t.numberPrevEvent(e),t.numberDownPrevEvent(e)},60)},numberDownNextEvent:function(e){var t=this;this.downbumTimeout=setTimeout(function(){t.numberNextEvent(e),t.numberDownNextEvent(e)},60)},numberKeydownEvent:function(e){var t=e.keyCode,a=38===t;(a||40===t)&&(e.preventDefault(),a?this.numberPrevEvent(e):this.numberNextEvent(e))},numberMousedownEvent:function(e){var t=this;if(this.numberStopDown(),0===e.button){var a=_tools.DomTools.hasClass(e.currentTarget,"is--prev");a?this.numberPrevEvent(e):this.numberNextEvent(e),this.downbumTimeout=setTimeout(function(){a?t.numberDownPrevEvent(e):t.numberDownNextEvent(e)},500)}},numberPrevEvent:function(e){var t=this.disabled,a=this.readonly;clearTimeout(this.downbumTimeout),t||a||this.numberChange(!0,e),this.$emit("prev-number",{$event:e})},numberNextEvent:function(e){var t=this.disabled,a=this.readonly;clearTimeout(this.downbumTimeout),t||a||this.numberChange(!1,e),this.$emit("next-number",{$event:e})},numberChange:function(e,t){var a=this.type,i=this.digits,n=this.value,s=this.stepValue,l="integer"===a?_xeUtils.default.toInteger(n):_xeUtils.default.toNumber(n),r=e?_xeUtils.default.add(l,s):_xeUtils.default.subtract(l,s);this.vaildMinNum(r)&&this.vaildMaxNum(r)&&this.emitUpdate("float"===a?_xeUtils.default.toFixedString(r,_xeUtils.default.toNumber(i)):""+r,t)},datePickerOpenEvent:function(e){e.preventDefault(),this.showPanel()},dateMonthHandle:function(e,t){this.selectMonth=_xeUtils.default.getWhatMonth(e,t,"first")},dateNowHandle:function(){var e=_xeUtils.default.getWhatDay(Date.now(),0,"first");this.currentDate=e,this.dateMonthHandle(e,0)},dateToggleTypeEvent:function(){var e=this.datePanelType;e="month"===e?"year":"month",this.datePanelType=e},datePrevEvent:function(){var e=this.type,t=this.datePanelType;this.selectMonth="year"===e?_xeUtils.default.getWhatYear(this.selectMonth,-16,"first"):"month"===e?"year"===t?_xeUtils.default.getWhatYear(this.selectMonth,-16,"first"):_xeUtils.default.getWhatYear(this.selectMonth,-1,"first"):"year"===t?_xeUtils.default.getWhatYear(this.selectMonth,-16,"first"):"month"===t?_xeUtils.default.getWhatYear(this.selectMonth,-1,"first"):_xeUtils.default.getWhatMonth(this.selectMonth,-1,"first")},dateTodayMonthEvent:function(){this.dateNowHandle(),this.dateChange(this.currentDate),this.hidePanel()},dateNextEvent:function(){var e=this.type,t=this.datePanelType;this.selectMonth="year"===e?_xeUtils.default.getWhatYear(this.selectMonth,16,"first"):"month"===e?"year"===t?_xeUtils.default.getWhatYear(this.selectMonth,16,"first"):_xeUtils.default.getWhatYear(this.selectMonth,1,"first"):"year"===t?_xeUtils.default.getWhatYear(this.selectMonth,16,"first"):"month"===t?_xeUtils.default.getWhatYear(this.selectMonth,1,"first"):_xeUtils.default.getWhatMonth(this.selectMonth,1,"first")},dateSelectEvent:function(e){isDateDisabled(this,e)||this.dateSelectItem(e.date)},dateSelectItem:function(e){var t=this.type,a=this.datePanelType;"month"===t?"year"===a?(this.datePanelType="month",this.dateCheckMonth(e)):(this.dateChange(e),this.hidePanel()):"year"===t?(this.hidePanel(),this.dateChange(e)):"month"===a?(this.datePanelType="week"===t?t:"day",this.dateCheckMonth(e)):"year"===a?(this.datePanelType="month",this.dateCheckMonth(e)):(this.dateChange(e),this.hidePanel())},dateMouseenterEvent:function(e){if(!isDateDisabled(this,e)){var t=this.datePanelType;"month"===t?this.dateMoveMonth(e.date):"year"===t?this.dateMoveYear(e.date):this.dateMoveDay(e.date)}},dateHourEvent:function(e,t){this.datetimePanelValue.setHours(t.value),this.dateTimeChangeEvent(e)},dateConfirmEvent:function(){this.dateChange(this.dateValue||this.currentDate),this.hidePanel()},dateMinuteEvent:function(e,t){this.datetimePanelValue.setMinutes(t.value),this.dateTimeChangeEvent(e)},dateSecondEvent:function(e,t){this.datetimePanelValue.setSeconds(t.value),this.dateTimeChangeEvent(e)},dateTimeChangeEvent:function(e){this.datetimePanelValue=new Date(this.datetimePanelValue.getTime()),this.updateTimePos(e.currentTarget)},updateTimePos:function(e){if(e){var t=e.offsetHeight;e.parentNode.scrollTop=e.offsetTop-4*t}},dateMoveDay:function(t){isDateDisabled(this,{date:t})||(this.dayList.some(function(e){return _xeUtils.default.isDateSame(e.date,t,"yyyy-MM-dd")})||this.dateCheckMonth(t),this.dateParseValue(t))},dateMoveMonth:function(t){isDateDisabled(this,{date:t})||(this.monthList.some(function(e){return _xeUtils.default.isDateSame(e.date,t,"yyyy-MM")})||this.dateCheckMonth(t),this.dateParseValue(t))},dateMoveYear:function(t){isDateDisabled(this,{date:t})||(this.yearList.some(function(e){return _xeUtils.default.isDateSame(e.date,t,"yyyy")})||this.dateCheckMonth(t),this.dateParseValue(t))},dateParseValue:function(e){var t=this.dateLabelFormat,a=this.parseFormat,i=e?_xeUtils.default.toStringDate(e,a||this.dateOpts.parseFormat):null,n="";_xeUtils.default.isDate(i)?n=_xeUtils.default.toDateString(i,t):i=null,this.datePanelValue=i,this.datePanelLabel=n},dateOffsetEvent:function(e){var t=this.isActivated,a=this.datePanelValue,i=this.datePanelType;if(t){e.preventDefault();var n=e.keyCode,s=37===n,l=38===n,r=39===n,u=40===n;if("year"===i){var o=_xeUtils.default.getWhatYear(a||Date.now(),0,"first");s?o=_xeUtils.default.getWhatYear(o,-1):l?o=_xeUtils.default.getWhatYear(o,-4):r?o=_xeUtils.default.getWhatYear(o,1):u&&(o=_xeUtils.default.getWhatYear(o,4)),this.dateMoveYear(o)}else if("month"===i){var d=_xeUtils.default.getWhatMonth(a||Date.now(),0,"first");s?d=_xeUtils.default.getWhatMonth(d,-1):l?d=_xeUtils.default.getWhatMonth(d,-4):r?d=_xeUtils.default.getWhatMonth(d,1):u&&(d=_xeUtils.default.getWhatMonth(d,4)),this.dateMoveMonth(d)}else{var h=a||_xeUtils.default.getWhatDay(Date.now(),0,"first");s?h=_xeUtils.default.getWhatDay(h,-1):l?h=_xeUtils.default.getWhatWeek(h,-1):r?h=_xeUtils.default.getWhatDay(h,1):u&&(h=_xeUtils.default.getWhatWeek(h,1)),this.dateMoveDay(h)}}},datePgOffsetEvent:function(e){if(this.isActivated){var t=33===e.keyCode;e.preventDefault(),t?this.datePrevEvent(e):this.dateNextEvent(e)}},dateChange:function(e){var t=this.value,a=this.type,i=this.datetimePanelValue,n=this.dateValueFormat;if("week"===a){var s=_xeUtils.default.toNumber(_xeUtils.default.isNumber(this.startWeek)?this.startWeek:this.dateOpts.startWeek);e=_xeUtils.default.getWhatWeek(e,0,s)}else"datetime"===a&&(e.setHours(i.getHours()),e.setMinutes(i.getMinutes()),e.setSeconds(i.getSeconds()));var l=_xeUtils.default.toDateString(e,n);this.dateCheckMonth(e),_xeUtils.default.isEqual(t,l)||this.emitUpdate(l,{type:"update"})},dateCheckMonth:function(e){var t=_xeUtils.default.getWhatMonth(e,0,"first");_xeUtils.default.isEqual(t,this.selectMonth)||(this.selectMonth=t)},dateOpenPanel:function(){var e=this,t=this.type,a=this.dateValue;-1<["year","month","week"].indexOf(t)?this.datePanelType=t:this.datePanelType="day",this.currentDate=_xeUtils.default.getWhatDay(Date.now(),0,"first"),a?(this.dateMonthHandle(a,0),this.dateParseValue(a)):this.dateNowHandle(),"datetime"===t&&(this.datetimePanelValue=this.datePanelValue||_xeUtils.default.getWhatDay(Date.now(),0,"first"),this.$nextTick(function(){_xeUtils.default.arrayEach(e.$refs.timeBody.querySelectorAll("li.is--selected"),e.updateTimePos)}))},dateRevert:function(){this.inputValue=this.datePanelLabel},updateZindex:function(){this.panelIndex<_tools.UtilTools.getLastZIndex()&&(this.panelIndex=_tools.UtilTools.nextZIndex())},showPanel:function(){var e=this,t=this.disabled,a=this.visiblePanel,i=this.isDatePicker;t||a||(clearTimeout(this.hidePanelTimeout),this.isActivated=!0,this.animatVisible=!0,i&&this.dateOpenPanel(),setTimeout(function(){e.visiblePanel=!0},10),this.updateZindex(),this.updatePlacement())},hidePanel:function(){var e=this;this.visiblePanel=!1,this.hidePanelTimeout=setTimeout(function(){e.animatVisible=!1},350)},updatePlacement:function(){var y=this;return this.$nextTick().then(function(){var e=y.$refs,t=y.transfer,a=y.placement,i=y.panelIndex,n=e.input,s=e.panel,l=n.offsetHeight,r=n.offsetWidth,u=s.offsetHeight,o=s.offsetWidth,d={zIndex:i},h=_tools.DomTools.getAbsolutePos(n),c=h.boundingTop,f=h.boundingLeft,p=h.visibleHeight,v=h.visibleWidth,m="bottom";if(t){var x=f,b=c+l;"top"===a?(m="top",b=c-u):(p<b+u+5&&(m="top",b=c-u),b<5&&(m="bottom",b=c+l)),v<x+o+5&&(x-=x+o+5-v),x<5&&(x=5),Object.assign(d,{left:"".concat(x,"px"),top:"".concat(b,"px"),minWidth:"".concat(r,"px")})}else"top"===a?(m="top",d.bottom="".concat(l,"px")):p<c+l+u&&(m="top",d.bottom="".concat(l,"px"));return y.panelStyle=d,y.panelPlacement=m,y.$nextTick()})},handleGlobalMousedownEvent:function(e){var t=this.$refs,a=this.$el,i=this.disabled,n=this.visiblePanel,s=this.isActivated;!i&&s&&(this.isActivated=_tools.DomTools.getEventTargetNode(e,a).flag||_tools.DomTools.getEventTargetNode(e,t.panel).flag,this.isActivated||(this.isDatePicker?n&&(this.hidePanel(),this.afterCheckValue()):this.afterCheckValue()))},handleGlobalKeydownEvent:function(e){var t=this.isDatePicker,a=this.visiblePanel,i=this.clearable;if(!this.disabled){var n=e.keyCode,s=9===n,l=46===n,r=27===n,u=13===n,o=38===n,d=40===n,h=33===n,c=34===n,f=37===n||o||39===n||d,p=this.isActivated;s?(p&&this.afterCheckValue(),p=!1,this.isActivated=p):f?t&&p&&(a?this.dateOffsetEvent(e):(o||d)&&(e.preventDefault(),this.showPanel())):u?t&&(a?this.datePanelValue?this.dateSelectItem(this.datePanelValue):this.hidePanel():p&&this.showPanel()):(h||c)&&t&&p&&this.datePgOffsetEvent(e),s||r?a&&this.hidePanel():l&&i&&p&&this.clearValueEvent(e,null)}},handleGlobalMousewheelEvent:function(e){var t=this.$refs,a=this.$el,i=this.disabled,n=this.visiblePanel;if(!i&&n){var s=_tools.DomTools.getEventTargetNode(e,a).flag;s||_tools.DomTools.getEventTargetNode(e,t.panel).flag?s&&this.updatePlacement():(this.hidePanel(),this.afterCheckValue())}},handleGlobalBlurEvent:function(){var e=this.isActivated;this.visiblePanel?(this.hidePanel(),this.afterCheckValue()):e&&this.afterCheckValue()}}};exports.default=_default2;