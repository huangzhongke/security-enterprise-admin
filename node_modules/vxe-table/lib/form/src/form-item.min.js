"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _xeUtils=_interopRequireDefault(require("xe-utils/methods/xe-utils")),_vXETable=_interopRequireDefault(require("../../v-x-e-table")),_tools=require("../../tools"),_conf=_interopRequireDefault(require("../../conf"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function renderPrefixIcon(e,t){return e("span",{class:"vxe-form--item-title-prefix"},[e("i",{class:t.icon||_conf.default.icon.FORM_PREFIX})])}function renderSuffixIcon(e,t){return e("span",{class:"vxe-form--item-title-suffix"},[e("i",{class:t.icon||_conf.default.icon.FORM_SUFFIX})])}function renderTitle(e,t){var i=t.title,l=t.titlePrefix,r=t.titleSuffix,n=[];return l&&n.push(l.message?e("vxe-tooltip",{props:{content:_tools.UtilTools.getFuncText(l.message),enterable:l.enterable,theme:l.theme}},[renderPrefixIcon(e,l)]):renderPrefixIcon(e,l)),n.push(e("span",{class:"vxe-form--item-title-label"},_tools.UtilTools.getFuncText(i))),r&&n.push(r.message?e("vxe-tooltip",{props:{content:_tools.UtilTools.getFuncText(r.message),enterable:r.enterable,theme:r.theme}},[renderSuffixIcon(e,r)]):renderSuffixIcon(e,r)),n}var _default={name:"VxeFormItem",props:{title:String,field:String,size:String,span:[String,Number],align:String,titleAlign:String,titleWidth:[String,Number],titlePrefix:Object,titleSuffix:Object,resetValue:{default:null},visibleMethod:Function,folding:Boolean,collapseNode:Boolean,itemRender:Object},inject:{$vxeform:{default:null}},data:function(){return{showError:!1,showRule:null}},computed:{vSize:function(){return this.size||this.$parent.size||this.$parent.vSize},isRequired:function(){var e=this.$vxeform,t=this.field;if(e&&e.rules){var i=e.rules[t];if(i)return i.some(function(e){return e.required})}return!1},errRule:function(){var e=this.$vxeform,i=this.field;return e?_xeUtils.default.find(e.invalids,function(e){var t=e.property;return i===t}):null}},watch:{errRule:function(e){var t=this;clearTimeout(this.showErrTimeout),this.showError=!1,e?(this.showRule=e.rule,setTimeout(function(){t.showError=!0},30)):this.showErrTimeout=setTimeout(function(){t.showRule=null},350)}},render:function(e){var t=this.$scopedSlots,i=this.$vxeform,l=this.title,r=this.folding,n=this.visibleMethod,o=this.field,s=this.collapseNode,a=this.itemRender,u=this.isRequired,f=this.showError,c=this.showRule,d=a?_vXETable.default.renderer.get(a.name):null,m=this.span||i.span,h=this.align||i.align,v=this.titleAlign||i.titleAlign,p=this.titleWidth||i.titleWidth,x=i.collapseAll,g=n;return!g&&d&&d.itemVisibleMethod&&(g=d.itemVisibleMethod),e("div",{class:["vxe-form--item",m?"vxe-col--".concat(m," is--span"):null,{"is--title":l,"is--required":u,"is--hidden":r&&x,"is--active":!g||g({data:i.data,property:o,$form:i}),"is--error":f}]},[e("div",{class:"vxe-form--item-inner"},[l?e("div",{class:["vxe-form--item-title",v?"align--".concat(v):null],style:p?{width:isNaN(p)?p:"".concat(p,"px")}:null},renderTitle(e,this)):null,e("div",{class:["vxe-form--item-content",h?"align--".concat(h):null]},(d&&d.renderItem?d.renderItem.call(this,e,a,{data:i.data,property:o,$form:i},{$form:i}):t.default?t.default.call(this,{data:i.data,property:o,$form:i},e):[]).concat([s?e("div",{class:"vxe-form--item-trigger-node",on:{click:this.toggleCollapseEvent}},[e("span",{class:"vxe-form--item-trigger-text"},x?_conf.default.i18n("vxe.form.unfolding"):_conf.default.i18n("vxe.form.folding")),e("i",{class:["vxe-form--item-trigger-icon",x?_conf.default.icon.FORM_FOLDING:_conf.default.icon.FORM_UNFOLDING]})]):null,c?e("div",{class:"vxe-form--item-valid",style:c.maxWidth?{width:"".concat(c.maxWidth,"px")}:null},c.message):null]))])])},methods:{toggleCollapseEvent:function(e){var t=this.$vxeform;t.toggleCollapse(),t.$emit("toggle-collapse",{collapse:!t.collapseAll,data:t.data,$form:t,$event:e},e)}}};exports.default=_default;