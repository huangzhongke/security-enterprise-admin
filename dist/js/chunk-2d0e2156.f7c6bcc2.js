(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0e2156"],{"7cd8":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{visible:t.visible,title:t.dataForm.id?t.$t("update"):t.$t("add"),"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(e){t.visible=e}}},[i("el-form",{ref:"dataForm",attrs:{model:t.dataForm,rules:t.dataRule,"label-width":"120px"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.dataFormSubmitHandle()}}},[i("el-form-item",{attrs:{prop:"title",label:t.$t("news.title")}},[i("el-input",{attrs:{placeholder:t.$t("news.title")},model:{value:t.dataForm.title,callback:function(e){t.$set(t.dataForm,"title",e)},expression:"dataForm.title"}})],1),i("el-form-item",{attrs:{prop:"content",label:t.$t("news.content")}},[i("div",{attrs:{id:"J_quillEditor"}}),i("el-upload",{staticStyle:{display:"none"},attrs:{action:t.uploadUrl,"show-file-list":!1,"before-upload":t.uploadBeforeUploadHandle,"on-success":t.uploadSuccessHandle}},[i("el-button",{ref:"uploadBtn",attrs:{type:"primary",size:"small"}},[t._v(t._s(t.$t("upload.button")))])],1)],1),i("el-form-item",{attrs:{prop:"pubDate",label:t.$t("news.pubDate")}},[i("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:t.$t("news.pubDate")},model:{value:t.dataForm.pubDate,callback:function(e){t.$set(t.dataForm,"pubDate",e)},expression:"dataForm.pubDate"}})],1)],1),i("template",{slot:"footer"},[i("el-button",{on:{click:function(e){t.visible=!1}}},[t._v(t._s(t.$t("cancel")))]),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.dataFormSubmitHandle()}}},[t._v(t._s(t.$t("confirm")))])],1)],2)},r=[],o=(i("99af"),i("a78e")),l=i.n(o),n=i("b047"),d=i.n(n),s=(i("8096"),i("9339")),u=i.n(s),c={data:function(){return{visible:!1,quillEditor:null,quillEditorToolbarOptions:[["bold","italic","underline","strike"],["blockquote","code-block","image"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"]],uploadUrl:"",dataForm:{id:"",title:"",content:"",pubDate:""}}},computed:{dataRule:function(){var t=this,e=function(e,i,a){if(t.quillEditor.getLength()<=1)return a(new Error(t.$t("validate.required")));a()};return{title:[{required:!0,message:this.$t("validate.required"),trigger:"blur"}],content:[{required:!0,message:this.$t("validate.required"),trigger:"blur"},{validator:e,trigger:"blur"}],pubDate:[{required:!0,message:this.$t("validate.required"),trigger:"blur"}]}}},methods:{init:function(){var t=this;this.visible=!0,this.$nextTick((function(){t.quillEditor?t.quillEditor.deleteText(0,t.quillEditor.getLength()):t.quillEditorHandle(),t.$refs["dataForm"].resetFields(),t.dataForm.id&&t.getInfo()}))},quillEditorHandle:function(){var t=this;this.quillEditor=new u.a("#J_quillEditor",{modules:{toolbar:this.quillEditorToolbarOptions},theme:"snow"}),this.uploadUrl="".concat(window.SITE_CONFIG["apiURL"],"/sys/oss/upload?token=").concat(l.a.get("token")),this.quillEditor.getModule("toolbar").addHandler("image",(function(){t.$refs.uploadBtn.$el.click()})),this.quillEditor.on("text-change",(function(){t.dataForm.content=t.quillEditor.root.innerHTML}))},uploadBeforeUploadHandle:function(t){if("image/jpg"!==t.type&&"image/jpeg"!==t.type&&"image/png"!==t.type&&"image/gif"!==t.type)return this.$message.error("只支持jpg、png、gif格式的图片！"),!1},uploadSuccessHandle:function(t,e,i){if(0!==t.code)return this.$message.error(t.msg);this.quillEditor.insertEmbed(this.quillEditor.getSelection().index,"image",t.data.src)},getInfo:function(){var t=this;this.$http.get("/demo/news/".concat(this.dataForm.id)).then((function(e){var i=e.data;if(0!==i.code)return t.$message.error(i.msg);t.dataForm=i.data,t.quillEditor.root.innerHTML=t.dataForm.content})).catch((function(){}))},dataFormSubmitHandle:d()((function(){var t=this;this.$refs["dataForm"].validate((function(e){if(!e)return!1;t.$http[t.dataForm.id?"put":"post"]("/demo/news",t.dataForm,{headers:{"content-type":"application/x-www-form-urlencoded"}}).then((function(e){var i=e.data;if(0!==i.code)return t.$message.error(i.msg);t.$message({message:t.$t("prompt.success"),type:"success",duration:500,onClose:function(){t.visible=!1,t.$emit("refreshDataList")}})})).catch((function(){}))}))}),1e3,{leading:!0,trailing:!1})}},p=c,m=i("2877"),f=Object(m["a"])(p,a,r,!1,null,null,null);e["default"]=f.exports}}]);